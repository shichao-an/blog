<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>Shichao's Blog</title>
        <link>http://blog.shichao-an.info/blog/html/</link>
        <description>Recording molecular stuff</description>
        <language>en-us</language>
        <pubDate>Fri, 02 May 2014 00:00:00 -0700</pubDate>
        
        <item>
            <link>http://blog.shichao-an.info/blog/html/2014/05/02/fixing_mongodb_against_unclean_shutdown.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2014/05/02/fixing_mongodb_against_unclean_shutdown.html</guid>
            <title><![CDATA[Fixing MongoDB against unclean shutdown]]></title>
            <description><![CDATA[<h1>Fixing MongoDB against unclean shutdown</h1>
<p>It’s been a while since I maintained one of my servers that host an old project. After I got an HTTP 500 in an occasional case, I logged in to check what happened, only to find MongoDB is down. Running <span class="docutils literal"><span class="pre">service</span> <span class="pre">mongod</span> <span class="pre">restart</span></span> does not work. The MongoDB log indicates “Unclean shutdown detected.”</p>
<p>After a search on Google, here’s what I did to fix that:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># grep dbpath /etc/mongod.conf</span>
<span class="go">dbpath=/var/lib/mongo</span>
<span class="go"># rm /var/lib/mongo/mongod.lock</span>
<span class="go"># mongod --repair --dbpath /var/lib/mongo</span>
</pre></div>
</div>
<p>At this point, you will see that MongoDB is running the repair process. If you immediately start MongoDB server after that, it still fails, because some permissions in /var/lib/mongo have been changed. You have to recover owner and group of those files back to “mongod” and then start the service:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># chown -R mongod:mongod /var/lib/mongo</span>
<span class="go"># service mongod restart</span>
</pre></div>
</div>
<p>Finally note that this is an CentOS server. If you use MongoDB on Ubuntu, some namings may be different.</p>
]]></description>
             <pubDate>Fri, 02 May 2014 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2014/05/01/get_number_of_bits_of_a_python_integer.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2014/05/01/get_number_of_bits_of_a_python_integer.html</guid>
            <title><![CDATA[Get number of bits of a Python integer]]></title>
            <description><![CDATA[<h1>Get number of bits of a Python integer</h1>
<p>A Python integer is represented as either of 32-bit or 64-bit signed integer type that is platform-specific, without considering it as <a class="reference external" href="https://docs.python.org/2.7/c-api/int.html">an Python object</a>. As indicated in the documentation, whether it is 32-bit or 64-bit can be revealed by checking <span class="docutils literal"><span class="pre">sys.maxsize</span></span> (or <span class="docutils literal"><span class="pre">sys.maxint</span></span> on older CPython implementations such as 2.4), the value of which “is the largest positive integer supported by the platform’s <span class="docutils literal"><span class="pre">Py_ssize_t</span></span> type and is usually <span class="docutils literal"><span class="pre">2**31</span> <span class="pre">-</span> <span class="pre">1</span></span> on a 32-bit platform and <span class="docutils literal"><span class="pre">2**63</span> <span class="pre">-</span> <span class="pre">1</span></span> on a 64-bit platform”. <a class="reference external" href="https://docs.python.org/2/library/sys.html">[1]</a> <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.maxsize">[2]</a>.</p>
<p>The following function helps determine number of bits of an integer and returns either 64 or 32 by leveraging the variable discussed above:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>


<span class="k">def</span> <span class="nf">get_int_bits</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">'maxsize'</span><span class="p">):</span>
        <span class="n">max_int</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">'maxsize'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">max_int</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">'maxint'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">max_int</span> <span class="o">&gt;&gt;</span> <span class="mi">62</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">32</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">64</span>
</pre></div>
</div>
<p>Check out the code on GitHub Gist from <a class="reference external" href="https://gist.github.com/shichao-an/b447d24f0a5381b0fa92">this link</a>.</p>
<p><strong>Updated Jun 10, 2014</strong></p>
<p>After an exploration of the <a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#int.bit_length">built-in types</a>, it is clear that <span class="docutils literal"><span class="pre">int.bit_length</span></span> can be used more easily than bit manipulation.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>


<span class="k">def</span> <span class="nf">get_int_bits</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">'maxsize'</span><span class="p">):</span>
        <span class="n">max_int</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">'maxsize'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">max_int</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">'maxint'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">max_int</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
]]></description>
             <pubDate>Thu, 01 May 2014 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2014/04/09/using_bash_arrays_and_ifs_to_manipulate_filenames.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2014/04/09/using_bash_arrays_and_ifs_to_manipulate_filenames.html</guid>
            <title><![CDATA[Using Bash arrays and IFS to manipulate filenames]]></title>
            <description><![CDATA[<h1>Using Bash arrays and IFS to manipulate filenames</h1>
<p>Assume we want to work with files in a directory. The most intuitive way is to make use of filename expansion, using globbing. We can use the <cite>for construct</cite> and wildcard <span class="docutils literal"><span class="pre">*</span></span> to handle each file nice and clean, without worrying about those filenames that contain whitespaces (suppose that in all of the following context, the working directory contain three files: “Foo”, “Bar”, and “Foo Bar”):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ for file in *; do echo "$file"; done</span>
</pre></div>
</div>
<p>We can also create an array from these filenames, using the following command:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ files=(*)</span>
</pre></div>
</div>
<p>Then, we can take a look at both the attributes and the value of <cite>files</cite>:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ declare -p files</span>
<span class="go">declare -a files='([0]="Bar" [1]="Foo" [2]="Foo Bar")'</span>
</pre></div>
</div>
<p>What if we want to create an array with specific orders, say by modification time (<cite>mtime</cite>) of files. We have to use the <span class="docutils literal"><span class="pre">ls</span></span> with the <span class="docutils literal"><span class="pre">-t</span></span> switch.  Now there are several practical scenarios discussed as follows.</p>
<ol class="arabic">
<li><p class="first">Get the latest modified filename:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ filename=$(ls -t | head -1)</span>
</pre></div>
</div>
</li>
<li><p class="first">Create an array of filenames ordered by their <cite>mtime</cite>. Clearly, globbing will not work because it is based on filename pattern matching. We have to use both command substitution and word splitting. Let’s try the following first:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ filenames=($(ls -t))</span>
<span class="go">$ declare -p filenames</span>
<span class="go">declare -a filenames='([0]="Foo" [1]="Bar" [2]="Bar" [3]="Foo")'</span>
</pre></div>
</div>
<p>Clearly this is not the result we want since the whitespace-contained filename is corrupted.</p>
<p>We need to hack a little on IFS variable. Let’s try what happens if we disable word splitting by setting IFS to null:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ IFS=</span>
<span class="go">$ filenames=($(ls -t))</span>
<span class="go">$ declare -p filenames</span>
<span class="go">declare -a filenames='([0]="Foo Bar</span>
<span class="go">Bar</span>
<span class="go">Foo")'</span>
</pre></div>
</div>
<p>It seems it’s getting worse this time. Since word splitting is not performed, the result of command substitution becomes an single word.</p>
<p>We know that the result of <span class="docutils literal"><span class="pre">ls</span></span> command is multiple lines of filenames. As the result of command substitution (i.e. <span class="docutils literal"><span class="pre">$(ls</span> <span class="pre">-t)</span></span>), the filenames are separated by newlines (<span class="docutils literal"><span class="pre">\n</span></span>). The default IFS is a sequence of <span class="docutils literal"><span class="pre">\t\n</span></span> (space, tab and newline), which means each of these characters will be used to delimit words. Here we need to suppress the effect of space; just set IFS to newline character (<span class="docutils literal"><span class="pre">\n</span></span>) (as long as your filenames does not contain newlines), with ANSI C quoting (<span class="docutils literal"><span class="pre">$''</span></span>):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ IFS=$'\n'</span>
<span class="go">$ filenames=($(ls -t))</span>
<span class="go">$ declare -p filenames</span>
<span class="go">declare -a filenames='([0]="Foo Bar" [1]="Bar" [2]="Foo")'</span>
</pre></div>
</div>
<p>In similar ways, we can get <cite>n</cite> most recently modified filenames, just make use of parameter expansion:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ echo "${filenames[@]:0:2}"  # Print two most recently modified names</span>
</pre></div>
</div>
</li>
</ol>
]]></description>
             <pubDate>Wed, 09 Apr 2014 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2014/04/04/bash_double_bracket_test_contructs_and_word_splitting.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2014/04/04/bash_double_bracket_test_contructs_and_word_splitting.html</guid>
            <title><![CDATA[Bash double brackets, test contructs and word splitting]]></title>
            <description><![CDATA[<h1>Bash double brackets, test contructs and word splitting</h1>
<p>We know that the double brackets constructs can be used in place of the <span class="docutils literal"><span class="pre">test</span></span> builtin (<span class="docutils literal"><span class="pre">[</span></span>) commonly used as single brackets to evaluate conditional expressions. The double brackets are preferred in terms of writing less error-prone scripts, though it is not POSIX-compliant (not portable to many other shells).</p>
<p>The primary difference of double brackets from the <span class="docutils literal"><span class="pre">test</span></span> builtin is that word splitting and filename expansion are not performed within them. It is easier to understand the filename expansion difference in this case, let’s take a look at the difference of word splitting.</p>
<ol class="arabic">
<li><p class="first">First, the following command fails because in <span class="docutils literal"><span class="pre">test</span></span> constructs the word splitting is performed after parameter expansion (and variable expansion, if any):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ bash -xc 'foobar="hello world"; [ $foobar = "hello world" ] &amp;&amp; echo "yes"'</span>
<span class="go">+ '[' hello world = 'hello world' ']'</span>
<span class="go">bash: line 0: [: too many arguments</span>
</pre></div>
</div>
</li>
<li><p class="first">In the double brackes, the error will not occur because word splitting is not performed, like the following:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ bash -xc 'foobar="hello world"; [[ $foobar = "hello world" ]] &amp;&amp; echo "yes"'</span>
<span class="go">+ foobar='hello world'</span>
<span class="go">+ [[ hello world = \h\e\l\l\o\ \w\o\r\l\d ]]</span>
<span class="go">+ echo yes</span>
<span class="go">yes</span>
</pre></div>
</div>
</li>
<li><p class="first">We can supress word splitting in the <span class="docutils literal"><span class="pre">test</span></span> construct by setting IFS to null, because when IFS is null, word splitting never occurs. This time, this command will succeed:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ bash -xc 'IFS=""; foobar="hello world"; [ $foobar = "hello world" ] &amp;&amp; echo "yes"'</span>
<span class="go">+ IFS=</span>
<span class="go">+ foobar='hello world'</span>
<span class="go">+ '[' 'hello world' = 'hello world' ']'</span>
<span class="go">+ echo yes</span>
<span class="go">yes</span>
</pre></div>
</div>
</li>
<li><p class="first">Another feature to note is that double brackets treat unset variables and null variable (variable whose value is a null string, i.e. ‘’)  differently from the <span class="docutils literal"><span class="pre">test</span></span> construct. For example:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ bash -xc 'IFS=""; foobar=""; [ $foobar = "hello world" ] &amp;&amp; echo "yes"'</span>
<span class="go">+ IFS=</span>
<span class="go">+ foobar=</span>
<span class="go">+ '[' = 'hello world' ']'</span>
<span class="go">bash: line 0: [: =: unary operator expected</span>

<span class="go">$ bash -xc 'IFS=""; foobar=""; [[ $foobar = "hello world" ]] &amp;&amp; echo "yes"'</span>
<span class="go">+ IFS=</span>
<span class="go">+ foobar=</span>
<span class="go">+ [[ '' = \h\e\l\l\o\ \w\o\r\l\d ]]</span>
</pre></div>
</div>
</li>
</ol>
<p>The unset or null variable is converted to null argument (<span class="docutils literal"><span class="pre">''</span></span>) as a result in double brackets, while in <span class="docutils literal"><span class="pre">test</span></span> constructs it is removed.</p>
<ol class="arabic" start="5">
<li><p class="first">You may notice in the second step above that the xtrace output of the conditional expression to the right of the operator is <span class="docutils literal"><span class="pre">\h\e\l\l\o\</span> <span class="pre">\w\o\r\l\d</span></span>. This is because when using operators <span class="docutils literal"><span class="pre">==</span></span>, <span class="docutils literal"><span class="pre">!=</span></span> and the POSIX version <span class="docutils literal"><span class="pre">=</span></span>, the string to the right is considered a pattern and pattern matching will be performed. The backslash indicates the each character is literal instead of pattern, because “hello world” is quoted. The following example makes the right string as pattern:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ bash -xc 'IFS=""; foobar="hello world"; [[ $foobar = hello* ]] &amp;&amp; echo "yes"'</span>
<span class="go">+ IFS=</span>
<span class="go">+ foobar='hello world'</span>
<span class="go">+ [[ hello world = hello* ]]</span>
<span class="go">+ echo yes</span>
<span class="go">yes</span>
</pre></div>
</div>
</li>
</ol>
]]></description>
             <pubDate>Fri, 04 Apr 2014 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2014/03/20/enabling_adobe_flash_player_plugin_for_google_chrome_on_fedora.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2014/03/20/enabling_adobe_flash_player_plugin_for_google_chrome_on_fedora.html</guid>
            <title><![CDATA[Enabling Adobe Flash Player plugin for Google Chrome on Fedora]]></title>
            <description><![CDATA[<h1>Enabling Adobe Flash Player plugin for Google Chrome on Fedora</h1>
<p>The Google Chrome browser I use was installed from the third-party repository by Google. The default Pepper Flash Player plugin (version 12.0) does not support some websites (such as <a class="reference external" href="http://www.bilibili.tv">www.bilibili.tv</a>). I have to install the Adobe Flash Player plugin and enable it for Google Chrome.</p>
<p>1. Install the repository from Adobe (assuming 64-bit):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># yum install http://linuxdownload.adobe.com/adobe-release/adobe-release-x86_64-1.0-1.noarch.rpm</span>
<span class="go"># rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-adobe-linux</span>
</pre></div>
</div>
<p>2. Install the flash-plugin package:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># yum install flash-plugin</span>
</pre></div>
</div>
<p>3. Create symbolic link at Google Chrome’s default directory:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># ln -s /usr/lib64/mozilla/plugins/libflashplayer.so /opt/google/chrome/libflashplayer.so</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li>Restart Google Chrome, go to “<a class="reference external" href="about:plugins">about:plugins</a>” page, toggle “Details” switch at upper right corner, disable PepperFlash plugin and enable the Adobe Flash Player plugin with location “/usr/lib64/flash-plugin/libflashplayer.so”</li>
</ol>
]]></description>
             <pubDate>Thu, 20 Mar 2014 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2014/03/17/setuid_and_uid_euid_and_suid.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2014/03/17/setuid_and_uid_euid_and_suid.html</guid>
            <title><![CDATA[setuid() and uid, euid and suid]]></title>
            <description><![CDATA[<h1>setuid() and uid, euid and suid</h1>
<p>We know that <cite>setuid</cite> bit allows a program to change its effective uid (euid) upon execution. I want to take a look at how <cite>setuid()</cite> system call works through the following experiment.</p>
<p>Open a terminal session and run the <span class="docutils literal"><span class="pre">passwd</span></span> command (a known <cite>setuid</cite> executable) in the background (it will be suspended with a “[stopped]” output because it requires password from stdin) and get its PID (let’s assume it’s 10401) with <span class="docutils literal"><span class="pre">echo</span> <span class="pre">$!</span></span>:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ passwd &amp;</span>
<span class="go">$ echo $!  # 10401</span>
</pre></div>
</div>
<p>Then, run <span class="docutils literal"><span class="pre">gdb</span></span> to attach to this process:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo gdb -p $!</span>
</pre></div>
</div>
<p>Open another terminal, the run the following command to get the line that represents the current real UID (<cite>uid</cite>), effective UID (<cite>euid</cite>), saved UID (<cite>suid</cite>) and file system UID (<cite>fsuid</cite>) of the previous <span class="docutils literal"><span class="pre">passwd</span></span> process:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ watch -n 1 grep -i 'uid' /proc/10401/task/10401/status</span>
<span class="go">Uid:    1000    0       0   0</span>
</pre></div>
</div>
<p>In the first terminal, you can call <cite>seteuid(1000)</cite> to change its <cite>euid</cite> to 1000:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">(gdb) call seteuid(1000)</span>
<span class="go">$1 = 0</span>
</pre></div>
</div>
<p>Then the output of the <span class="docutils literal"><span class="pre">watch</span></span> command will become:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">Uid:    1000    1000    0   1000</span>
</pre></div>
</div>
<p>As you see the <cite>euid</cite> is 1000 and the process becomes unprivileged. With the following command, you will notice that the USER field has been changed to the regular user instead of root:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ ps -u -p 10401</span>
</pre></div>
</div>
<p class="readmorewrapper"><a class="readmore" href="http://blog.shichao-an.info/blog/html/2014/03/17/setuid_and_uid_euid_and_suid.html#more">Read more...</a></p> 
 
 
 
 
]]></description>
             <pubDate>Mon, 17 Mar 2014 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2014/03/05/suppressing_fedora.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2014/03/05/suppressing_fedora.html</guid>
            <title><![CDATA[Suppressing Fedora NetworkManager's prompt to connect to WPA Enterprise wireless networks]]></title>
            <description><![CDATA[<h1>Suppressing Fedora NetworkManager’s prompt to connect to WPA Enterprise wireless networks</h1>
<p>This seems to be an unsolved bug (<a class="reference external" href="https://bugzilla.redhat.com/show_bug.cgi?id=982429">#982429</a>) still under discussion. Many give temporary solutions that modify the corresponding <span class="docutils literal"><span class="pre">ifcfg-*</span></span> file and specify the password, possibly in plaintext form. Some suggest encrypting the password using <span class="docutils literal"><span class="pre">wpa_passphrase</span> <span class="pre">ESSID</span></span> command. The problematic network here is “nyu” of the New York University. Every time I turned on my laptop on the campus, it prompts with a dialog (though the password is actually stored) for me to click the “Connect” button, which is annoying. However, the encryption method does not work as far as I am concerned with Fedora 20. So I just followed the plaintext way to produce a temporary fix for that::</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># cd /etc/sysconfig/network-scripts</span>
<span class="go"># vim ifcfg-nyu</span>
</pre></div>
</div>
<p>Comment or remove the following line:</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="na">IEEE_8021X_PASSWORD_FLAGS</span><span class="o">=</span><span class="s">user</span>
</pre></div>
</div>
<p>Create a new file named <span class="docutils literal"><span class="pre">keys-nyu</span></span> in this directory with your password:</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="na">IEEE_8021X_PASSWORD</span><span class="o">=</span><span class="s">'your_password'</span>
</pre></div>
</div>
<p>Don’t forget to make it read-writable by root only:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># chmod 600 keys-nyu</span>
</pre></div>
</div>
<p>Then restart your network interface associated with “nyu”::</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># ifdown nyu</span>
<span class="go"># ifup nyu</span>
</pre></div>
</div>
<p>Then, the wireless network should work as expected. Try to logout or reboot to see if it surely works.</p>
]]></description>
             <pubDate>Wed, 05 Mar 2014 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2014/01/16/artistic_style_vim.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2014/01/16/artistic_style_vim.html</guid>
            <title><![CDATA[Use Artistic Style with vim]]></title>
            <description><![CDATA[<h1>Use Artistic Style with vim</h1>
<p>Artistic Style is a “Free, Fast and Small Automatic Formatter for C, C++, C++/CLI, C#, and Java Source Code”. It is basically a utility that reformats source code in a conventionally-defined indent and coding style.</p>
<p>First, install the program.</p>
<p>On Ubuntu/Debian:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo apt-get install astyle</span>
</pre></div>
</div>
<p>On OS X (with Homebrew):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ brew install astyle</span>
</pre></div>
</div>
<p>In order to use the command in a simple manner, you can set options in the options file <cite>~/.astylerc</cite>. I use the following options that uses Kernighan &amp; Ritchie (K&amp;R) style. For more supported styles and options, see <a class="reference external" href="http://astyle.sourceforge.net/astyle.html">http://astyle.sourceforge.net/astyle.html</a>.</p>
<div class="highlight-text"><div class="highlight"><pre>--style=kr
--indent=spaces=4
--indent-preprocessor
--pad-oper
--pad-header
--max-instatement-indent=40
--align-pointer=name
--align-reference=name
--keep-one-line-statements
--convert-tabs
--max-code-length=79
--pad-method-colon=none
</pre></div>
</div>
<p>Open vim, gVim or MacVim, and after editing some C/C++ files, use the following command to reformat the source code:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">:%!astyle</span>
</pre></div>
</div>
]]></description>
             <pubDate>Thu, 16 Jan 2014 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2013/11/17/sync_sleep_wakeup_ethernet_lan.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2013/11/17/sync_sleep_wakeup_ethernet_lan.html</guid>
            <title><![CDATA[Synchronize sleep and wakeup of machines on Ethernet LAN from Mac using SleepWatcher]]></title>
            <description><![CDATA[<h1>Synchronize sleep and wakeup of machines on Ethernet LAN from Mac using SleepWatcher</h1>
<p>The <a class="reference internal" href="http://blog.shichao-an.info/blog/html/2013/11/10/wake_suspend_machines_local_ethernet.html"><em>previous post</em></a> discusses remote suspend (sleep) and wakeup of machines on Ethernet LAN using pm-utils, GNU Screen and Wake-on-LAN (LAN). This post will discuss the synchronization of such behaviors of local and remote machines.</p>
<p>Suppose you are regularly working at home on a Mac (either MacBook or Mac mini or something else), and you have a spare PC running as an alternative to NAS or workstation on the same Ethernet LAN. If the spare PC is Linux, you may have set up netatalk on it to enable AFP file sharing or use it as a Time Capsule. However, since it is probably a netbook and may work only when your Mac is up, you don’t want it to run all days without doing anything. You can thus synchronize sleep and wakeup of your Mac with that PC.</p>
<p>You can download and install SleepWatcher to monitor sleep and wakeup on Mac and write some scripts upon these events.</p>
<ol class="arabic">
<li><p class="first">Download <a class="reference external" href="http://www.bernhard-baehr.de/sleepwatcher_2.2.tgz">SleepWatcher</a> (version 2.2 as of writing)</p>
</li>
<li><p class="first">Install it following the ReadMe.rtf instructions</p>
</li>
<li><p class="first">After the SleepWatcher LaunchAgent or LaunchDaemon is loaded, run the following commands to add sleep and wakeup scripts:</p>
<div class="highlight-python"><div class="highlight"><pre>$ echo "/path/to/your/sleep_script.sh" &gt; ~/.sleep
$ echo "sleep 5; /path/to/your/wakeup_script.sh" &gt; ~/.wakeup
$ chmod +x ~/.sleep ~/.wakeup
</pre></div>
</div>
</li>
</ol>
<p><span class="docutils literal"><span class="pre">/path/to/your/sleep_script.sh</span></span> and <span class="docutils literal"><span class="pre">/path/to/your/wakeup_script.sh</span></span> are scripts to suspend and wakeup the remote machine (reference the previous post). <span class="docutils literal"><span class="pre">sleep</span> <span class="pre">5</span></span> performs a delay to make sure the network is up to avoid “send : No route to host” error.
4. Test the setup by sleeping and waking up your Mac and check whether the remote machine does the same</p>
]]></description>
             <pubDate>Sun, 17 Nov 2013 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2013/11/10/wake_suspend_machines_local_ethernet.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2013/11/10/wake_suspend_machines_local_ethernet.html</guid>
            <title><![CDATA[Wake and suspend machines on local Ethernet LAN]]></title>
            <description><![CDATA[<h1>Wake and suspend machines on local Ethernet LAN</h1>
<p>Suppose you have a spare PC (say A) that supports Wake-on-LAN, you can first enable it by following <a class="reference external" href="http://www.cyberciti.biz/tips/linux-send-wake-on-lan-wol-magic-packets.html">this guide</a>. Then you can hack on some scripts on other local machines connected through Ethernet to remotely control A to make it suspend/hibernate and wake up as you want.</p>
<div class="section" id="wake">
<h2>Wake</h2>
<p>To wake up A is simple. Suppose A’s MAC address is 11:aa:22:bb:33:cc and the hostname is “machine-a”, and you want to wake it up from other machines (e.g. Machine B) on LAN, first install the wakeonlan utility (on Machine B).</p>
<p>On Debian/Ubuntu:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo apt-get install etherwake</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo apt-get install wakeonlan</span>
</pre></div>
</div>
<p>On Fedora/RHEL:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo apt-get install net-tools</span>
</pre></div>
</div>
<p>On OS X:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ brew install wakeonlan</span>
</pre></div>
</div>
<p>To send magic Wake-on-LAN packets to A:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ etherwake 11:aa:22:bb:33:cc</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ ether-wake 11:aa:22:bb:33:cc</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ wakeonlan 11:aa:22:bb:33:cc</span>
</pre></div>
</div>
</div>
<div class="section" id="suspend-hibernate">
<h2>Suspend/hibernate</h2>
<p class="readmorewrapper"><a class="readmore" href="http://blog.shichao-an.info/blog/html/2013/11/10/wake_suspend_machines_local_ethernet.html#more">Read more...</a></p> 
 
 
 
 
 
</div>
]]></description>
             <pubDate>Sun, 10 Nov 2013 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2013/11/05/apache_name_based_virtual_hosts.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2013/11/05/apache_name_based_virtual_hosts.html</guid>
            <title><![CDATA[Apache name-based virtual hosts and reverse DNS]]></title>
            <description><![CDATA[<h1>Apache name-based virtual hosts and reverse DNS</h1>
<p>On some operating systems such as Ubuntu, you can setup virtual hosts quite easily with the default Apache server (installed with APT). The global configuration file /etc/apache2/apache2.conf contains the following line as the last line by default:</p>
<div class="highlight-apache"><div class="highlight"><pre><span class="nb">Include</span> sites-enabled/
</pre></div>
</div>
<p>This means all virtual hosts configurations are loaded from the /etc/apache2/sites-enabled directory in alphabetical order. If you list this directory, you will find there is already a symbolic link 000-default that points to /etc/apache2/sites-available/default. This default virtual host configuration file does not contain a <span class="docutils literal"><span class="pre">ServerName</span></span> directive, and neither does the global configuration file (/etc/apache2/apache2.conf) by default. The default port.conf contains the following line:</p>
<div class="highlight-apache"><div class="highlight"><pre><span class="nb">NameVirtualHost</span> *:80
</pre></div>
</div>
<p>This means all the following name-virtual hosts will follow this <span class="docutils literal"><span class="pre">NameVirtualHost</span></span> directive, which receives requests on all interfaces on the server. <sup>[1]</sup></p>
<p>Basically, you can place your own virtual host configuration file in /etc/apache2/sites-available directory and use the a2ensite command to enable this configuration (by creating a symbolic link at /etc/apache2/sites-enabled that Apache will load). If you owns a domain example.com and a subdomain wiki.example.com that both points to the IP address of this server, you can create a virtual host with <span class="docutils literal"><span class="pre">ServerName</span> <span class="pre">wiki.example.com</span></span> (the argument to <span class="docutils literal"><span class="pre">&lt;VirtualHost&gt;</span></span> is *:80 in this case). If the configuration filename is wiki, you can use a2ensite wiki command to enable it.</p>
<p>Given these, let’s see how Apache handles requests for virtual hosts. When a request arrives, the server will find the best (most specific) matching <span class="docutils literal"><span class="pre">&lt;VirtualHost&gt;</span></span> argument based on the IP address and port used by the request. If there is more than one virtual host containing this best-match address and port combination, Apache will further compare the <span class="docutils literal"><span class="pre">ServerName</span></span> and <span class="docutils literal"><span class="pre">ServerAlias</span></span> directives to the server name present in the request. <sup>[2]</sup></p>
<p>If you try to visit wiki.example.com you actually request the IP of this server. The Apache server will handle this request by comparing active virtual host configurations. It first checks 000-default, but detects no <span class="docutils literal"><span class="pre">ServerName</span></span> directive (neither does the global configuration as mentioned before). As a result, it performs a reverse DNS lookup to find the <span class="docutils literal"><span class="pre">ServerName</span></span>. <sup>[3]</sup> If you have not setup a reverse DNS for this IP to wiki.example.com, the match will fail and Apache continues to match the next virtual host, wiki, which does have a <span class="docutils literal"><span class="pre">ServerName</span></span>, wiki.example.com, and this is a match. Apache will respond with this virtual host.</p>
<p>However, if you have recently setup a reverse DNS for IP of your server to wiki.example.com, a different result will come out. When you access wiki.example.com, Apache first checks 000-default, and performs a reverse DNS resolution only to find wiki.example.com as the result for <span class="docutils literal"><span class="pre">ServerName</span></span>, and this is a match. Apache will respond with 000-default instead of wiki and you will browse Web page for 000-default rather than wiki. To solve this problem, you can either set a global <span class="docutils literal"><span class="pre">ServerName</span></span> with example.com at /etc/apache2/apache2.conf or specify a <span class="docutils literal"><span class="pre">ServerName</span></span> for 000-default. In this way, the Apache will match the right <span class="docutils literal"><span class="pre">ServerName</span></span> with your request even if you setup a reverse DNS for one of the virtual hosts.</p>
<div class="section" id="reference">
<h2>Reference</h2>
<ol class="arabic simple">
<li><a class="reference external" href="http://httpd.apache.org/docs/2.2/mod/core.html#namevirtualhost">http://httpd.apache.org/docs/2.2/mod/core.html#namevirtualhost</a></li>
<li><a class="reference external" href="http://httpd.apache.org/docs/current/vhosts/name-based.html">http://httpd.apache.org/docs/current/vhosts/name-based.html</a></li>
<li><a class="reference external" href="http://httpd.apache.org/docs/current/dns-caveats.html">http://httpd.apache.org/docs/current/dns-caveats.html</a></li>
</ol>
</div>
]]></description>
             <pubDate>Tue, 05 Nov 2013 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2013/10/25/amazon_ec2_auto_scaling_example.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2013/10/25/amazon_ec2_auto_scaling_example.html</guid>
            <title><![CDATA[Amazon EC2 Auto Scaling example]]></title>
            <description><![CDATA[<h1>Amazon EC2 Auto Scaling example</h1>
<p>The following code creates an Auto Scaling group with scale-up and scale-down policies based on the monitoring the CPU utilization of either a specific EC2 instance or instances within the Auto Scaling group cluster.</p>
<p>If <span class="docutils literal"><span class="pre">alarm_dimensions</span></span> specifies <span class="docutils literal"><span class="pre">InstanceId</span></span>, the Auto Scaling group will scale up or down according to the CPU utilization of the specified running instance; if <span class="docutils literal"><span class="pre">alarm_dimensions</span></span> specifies <span class="docutils literal"><span class="pre">AutoScalingGroupName</span></span>, the Auto Scaling group will scale up or down according to the CPU utilization of instances within its existing cluster. For more metrics and dimensions in CloudWatch, see <a class="reference external" href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/ec2-metricscollected.html">Amazon Elastic Compute Cloud Dimensions and Metrics</a>.</p>
<p>Raw code can be <a class="reference external" href="https://raw.githubusercontent.com/moleculea/autoscale_sample/master/autoscale_sample.py">downloaded here</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">boto.ec2</span>
<span class="kn">from</span> <span class="nn">boto.ec2.autoscale</span> <span class="kn">import</span> <span class="p">(</span><span class="n">AutoScalingGroup</span><span class="p">,</span>
                                <span class="n">LaunchConfiguration</span><span class="p">,</span> <span class="n">ScalingPolicy</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">boto.ec2.cloudwatch</span> <span class="kn">import</span> <span class="n">MetricAlarm</span>


<span class="c"># Create connections to Auto Scaling and CloudWatch</span>
<span class="n">as_conn</span> <span class="o">=</span> <span class="n">boto</span><span class="o">.</span><span class="n">ec2</span><span class="o">.</span><span class="n">autoscale</span><span class="o">.</span><span class="n">connect_to_region</span><span class="p">(</span><span class="s">"us-east-1"</span><span class="p">)</span>
<span class="n">cw_conn</span> <span class="o">=</span> <span class="n">boto</span><span class="o">.</span><span class="n">ec2</span><span class="o">.</span><span class="n">cloudwatch</span><span class="o">.</span><span class="n">connect_to_region</span><span class="p">(</span><span class="s">"us-east-1"</span><span class="p">)</span>

<span class="c"># Name for auto scaling group and launch configuration</span>
<span class="n">as_name</span> <span class="o">=</span> <span class="s">"VM1"</span>

<span class="c"># Create launch configuration</span>
<span class="n">lc</span> <span class="o">=</span> <span class="n">LaunchConfiguration</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span>
                         <span class="n">image_id</span><span class="o">=</span><span class="s">"ami-76f0061f"</span><span class="p">,</span>  <span class="c"># AMI ID of your instance</span>
                         <span class="n">key_name</span><span class="o">=</span><span class="s">"your_key_name"</span><span class="p">,</span>
                         <span class="n">security_groups</span><span class="o">=</span><span class="s">"your_group_name"</span><span class="p">,</span>
                         <span class="n">instance_type</span><span class="o">=</span><span class="s">"t1.micro"</span><span class="p">,</span>
                         <span class="n">instance_monitoring</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">as_conn</span><span class="o">.</span><span class="n">create_launch_configuration</span><span class="p">(</span><span class="n">lc</span><span class="p">)</span>

<span class="c"># Create Auto Scaling group</span>
<span class="n">ag</span> <span class="o">=</span> <span class="n">AutoScalingGroup</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span>
                      <span class="n">availability_zones</span><span class="o">=</span><span class="p">[</span><span class="s">"us-east-1b"</span><span class="p">],</span>
                      <span class="n">launch_config</span><span class="o">=</span><span class="n">lc</span><span class="p">,</span> <span class="n">min_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                      <span class="n">max_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                      <span class="n">connection</span><span class="o">=</span><span class="n">as_conn</span><span class="p">)</span>

<span class="n">as_conn</span><span class="o">.</span><span class="n">create_auto_scaling_group</span><span class="p">(</span><span class="n">ag</span><span class="p">)</span>

<span class="c"># Create scaling policies</span>
<span class="n">scale_up_policy</span> <span class="o">=</span> <span class="n">ScalingPolicy</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">'scale_up'</span><span class="p">,</span> <span class="n">adjustment_type</span><span class="o">=</span><span class="s">'ChangeInCapacity'</span><span class="p">,</span>
    <span class="n">as_name</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span> <span class="n">scaling_adjustment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cooldown</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span>

<span class="n">scale_down_policy</span> <span class="o">=</span> <span class="n">ScalingPolicy</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">'scale_down'</span><span class="p">,</span> <span class="n">adjustment_type</span><span class="o">=</span><span class="s">'ChangeInCapacity'</span><span class="p">,</span>
    <span class="n">as_name</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span> <span class="n">scaling_adjustment</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cooldown</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span>

<span class="n">as_conn</span><span class="o">.</span><span class="n">create_scaling_policy</span><span class="p">(</span><span class="n">scale_up_policy</span><span class="p">)</span>
<span class="n">as_conn</span><span class="o">.</span><span class="n">create_scaling_policy</span><span class="p">(</span><span class="n">scale_down_policy</span><span class="p">)</span>

<span class="n">scale_up_policy</span> <span class="o">=</span> <span class="n">as_conn</span><span class="o">.</span><span class="n">get_all_policies</span><span class="p">(</span>
    <span class="n">as_group</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span> <span class="n">policy_names</span><span class="o">=</span><span class="p">[</span><span class="s">'scale_up'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">scale_down_policy</span> <span class="o">=</span> <span class="n">as_conn</span><span class="o">.</span><span class="n">get_all_policies</span><span class="p">(</span>
    <span class="n">as_group</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span> <span class="n">policy_names</span><span class="o">=</span><span class="p">[</span><span class="s">'scale_down'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

<span class="c"># Set dimensions for CloudWatch alarms</span>
<span class="c"># Monitor on a specific instance</span>
<span class="n">alarm_dimensions</span> <span class="o">=</span> <span class="p">{</span><span class="s">"InstanceId"</span><span class="p">:</span> <span class="s">"your_instance_id"</span><span class="p">}</span>

<span class="c"># Monitor instances within the Auto Scaling group cluster</span>
<span class="n">alarm_dimensions_as</span> <span class="o">=</span> <span class="p">{</span><span class="s">"AutoScalingGroupName"</span><span class="p">:</span> <span class="n">as_name</span><span class="p">}</span>

<span class="c"># Create metric alarms</span>
<span class="n">scale_up_alarm</span> <span class="o">=</span> <span class="n">MetricAlarm</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">'scale_up_on_cpu_'</span> <span class="o">+</span> <span class="n">as_name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s">'AWS/EC2'</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s">'CPUUtilization'</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s">'Average'</span><span class="p">,</span>
    <span class="n">comparison</span><span class="o">=</span><span class="s">'&gt;'</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s">"80"</span><span class="p">,</span>
    <span class="n">period</span><span class="o">=</span><span class="s">'60'</span><span class="p">,</span> <span class="n">evaluation_periods</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">alarm_actions</span><span class="o">=</span><span class="p">[</span><span class="n">scale_up_policy</span><span class="o">.</span><span class="n">policy_arn</span><span class="p">],</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="n">alarm_dimensions</span><span class="p">)</span>

<span class="n">scale_down_alarm</span> <span class="o">=</span> <span class="n">MetricAlarm</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">'scale_down_on_cpu_'</span> <span class="o">+</span> <span class="n">as_name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s">'AWS/EC2'</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s">'CPUUtilization'</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s">'Average'</span><span class="p">,</span>
    <span class="n">comparison</span><span class="o">=</span><span class="s">'&lt;'</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s">"20"</span><span class="p">,</span>
    <span class="n">period</span><span class="o">=</span><span class="s">'60'</span><span class="p">,</span> <span class="n">evaluation_periods</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">alarm_actions</span><span class="o">=</span><span class="p">[</span><span class="n">scale_down_policy</span><span class="o">.</span><span class="n">policy_arn</span><span class="p">],</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="n">alarm_dimensions</span><span class="p">)</span>

<span class="c"># Create alarms in CloudWatch</span>
<span class="n">cw_conn</span><span class="o">.</span><span class="n">create_alarm</span><span class="p">(</span><span class="n">scale_up_alarm</span><span class="p">)</span>
<span class="n">cw_conn</span><span class="o">.</span><span class="n">create_alarm</span><span class="p">(</span><span class="n">scale_down_alarm</span><span class="p">)</span>
</pre></div>
</div>
]]></description>
             <pubDate>Fri, 25 Oct 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2013/09/17/sync_backup_files_over_lan_ssh_osx.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2013/09/17/sync_backup_files_over_lan_ssh_osx.html</guid>
            <title><![CDATA[Sync and backup files from a host on the LAN over SSH on Mac OS X]]></title>
            <description><![CDATA[<h1>Sync and backup files from a host on the LAN over SSH on Mac OS X</h1>
<p>Suppose you have several computers on an LAN, where DHCP is enabled. On Machine B, you want to routinely back up files from Machine A, whose IP address may change. This can be done using SSH and a local DNS server. The following experiment is done on two Mac OS X 10.8 machines.</p>
<ol class="arabic">
<li><p class="first">Set up DNS server (optional):</p>
<p><em>named</em> and <em>rndc</em> utility are installed by default on Mac OS X 10.8. For references on setup, see <a class="reference external" href="http://www.macshadows.com/kb/index.php?title=How_To:_Enable_BIND_-_Mac_OS_X">this link</a>.</p>
<ol class="arabic">
<li><p class="first">Use <span class="docutils literal"><span class="pre">rndc-confgen</span></span> to generate configuration and secret key:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo bash -c "rndc-confgen -b 256 &gt; /etc/rndc.conf"</span>
<span class="go">$ sudo bash -c " head -n5 /etc/rndc.conf | tail -n4 &gt; /etc/rndc.key"</span>
</pre></div>
</div>
</li>
<li><p class="first">Edit /etc/named.conf and /etc/rndc.conf to ensure the port number are the same</p>
</li>
<li><p class="first">Start named server, run “rndc status” to check whether it is started:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ launchctl load -w /System/Library/LaunchDaemons/org.isc.named.plist</span>
<span class="go">$ launchctl start org.isc.named</span>
<span class="go">$ rndc status</span>
</pre></div>
</div>
</li>
<li><p class="first">Create a zone file for the target machine (Machine A in this case):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ cd ~/Documents/</span>
<span class="go">$ mkdir named</span>
<span class="go">$ cd named</span>
<span class="go">$ vi machine-a.zone</span>
</pre></div>
</div>
<p>Copy the following text in to machine-a.zone, the IP address 192.168.0.120 is irrelevant at this time:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$TTL 86400</span>
<span class="go">$ORIGIN machine-a.</span>

<span class="go">@       IN      SOA     @ root (</span>
<span class="go">                        2013091701      ; serial number YYMMDDNN</span>
<span class="go">                        28800           ; Refresh</span>
<span class="go">                        7200            ; Retry</span>
<span class="go">                        864000          ; Expire</span>
<span class="go">                        86400           ; Min TTL</span>
<span class="go">            )</span>
<span class="go">        IN      NS      @</span>
<span class="go">        IN      A       192.168.0.120   ; lan-sync</span>
</pre></div>
</div>
</li>
<li><p class="first">Create symbolic link at /var/named/machine-a.zone (/private/var/named/machine-a.zone):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ ln -s /Users/yourname/Documents/named/machine-a.zone /private/var/named/machine-a.zone</span>
</pre></div>
</div>
</li>
<li><p class="first">Edit /etc/named.conf, insert the following lines after the existing zone configurations:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">zone "machine-a" IN {</span>
<span class="go">        type master;</span>
<span class="go">        file "machine-a.zone";</span>
<span class="go">        allow-update { none; };</span>
<span class="go">};</span>
</pre></div>
</div>
</li>
<li><p class="first">Edit /etc/resolv.conf, replace existing nameserver with 127.0.0.1. This file should look like this:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">#</span>
<span class="go"># This file is automatically generated.</span>
<span class="go">#</span>
<span class="go">nameserver 127.0.0.1</span>
</pre></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Download the script and set the following variables in ssh_sync.sh:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ git clone https://github.com/moleculea/lan-sync-over-ssh</span>
<span class="go">$ cd lan-sync-over-ssh</span>
<span class="go">$ vi ssh_sync.sh</span>

<span class="go">user_home="/Users/yourname"</span>
<span class="go"># Remote hostname (LAN) and MAC address</span>
<span class="go">hostname="machine-a"</span>
<span class="go"># User name on the remote host</span>
<span class="go">username="yourname"</span>
<span class="go">mac_address="11:11:11:11:11:11"</span>
</pre></div>
</div>
</li>
</ol>
<p class="readmorewrapper"><a class="readmore" href="http://blog.shichao-an.info/blog/html/2013/09/17/sync_backup_files_over_lan_ssh_osx.html#more">Read more...</a></p> 
 
 
]]></description>
             <pubDate>Tue, 17 Sep 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2013/09/15/fetch_convert_online_flash_videos.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2013/09/15/fetch_convert_online_flash_videos.html</guid>
            <title><![CDATA[Fetch and convert online flash videos]]></title>
            <description><![CDATA[<h1>Fetch and convert online flash videos</h1>
<ol class="arabic">
<li><p class="first">Installation of prerequisite utilities:</p>
<ul class="simple">
<li>Perl module: WWW::Mechanize</li>
<li><a class="reference external" href="https://code.google.com/p/get-flash-videos/wiki/Installation">get-flash-videos</a></li>
<li><a class="reference external" href="http://www.ffmpeg.org/download.html">ffmpeg</a></li>
</ul>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo cpan install WWW::Mechanize</span>
<span class="go">$ git clone https://github.com/monsieurvideo/get-flash-videos.git /path/to/get-flash-videos</span>
<span class="go">$ ln -s /usr/local/bin/get_flash_videos /path/to/get-flash-videos/get_flash_videos</span>
</pre></div>
</div>
<p>For the installation of ffmpeg, see <a class="reference external" href="http://www.ffmpeg.org/download.html">http://www.ffmpeg.org/download.html</a>.</p>
</li>
<li><p class="first">Download flash-video-archiver scripts:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ git clone https://github.com/moleculea/flash-video-archiver.git flash-video-archiver</span>
</pre></div>
</div>
</li>
<li><p class="first">Create a file of video link list, e.g. videos.txt:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ cat /path/to/videos.txt</span>

<span class="go">http://example.com/video/4438</span>
<span class="go">http://example.com/video/4512</span>
<span class="go">http://example.org/video/hjkl</span>
</pre></div>
</div>
</li>
<li><p class="first">Fetch videos and convert them into MP4:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ cd flash-video-archiver</span>
<span class="go">$ ./fetch.sh /path/to/videos.txt /path/to/output/directory</span>
<span class="go">$ ./convert.sh /path/to/output/directory</span>
</pre></div>
</div>
</li>
</ol>
]]></description>
             <pubDate>Sun, 15 Sep 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2013/08/09/setup_selenium_python_environment_x_ubuntu.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2013/08/09/setup_selenium_python_environment_x_ubuntu.html</guid>
            <title><![CDATA[Set up Selenium Python environment with X virtual framebuffer on Ubuntu server]]></title>
            <description><![CDATA[<h1>Set up Selenium Python environment with X virtual framebuffer on Ubuntu server</h1>
<ol class="arabic">
<li><p class="first">Install relevant APT packages:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo apt-get install xorg</span>
<span class="go">$ sudo apt-get install xfvd</span>
<span class="go">$ sudo apt-get install firefox</span>
<span class="go">$ sudo apt-get install openjdk-7-jre</span>
<span class="go">$ sudo apt-get install python-pip</span>
</pre></div>
</div>
</li>
<li><p class="first">Download Selenium server and Python bindings:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo pip install selenium</span>
<span class="go">$ wget https://selenium.googlecode.com/files/selenium-server-standalone-2.34.0.jar</span>
</pre></div>
</div>
</li>
<li><p class="first">Start virtual framebuffer X server for server number 1 (for DISPLAY) in the background:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo Xvfb :1 &amp;</span>
<span class="go">$ sudo Xvfb :1 -screen 0 1280x1024x8</span>
</pre></div>
</div>
</li>
<li><p class="first">Start Selenium server in the background (without sudo):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ java -jar selenium-server-standalone-2.34.0.jar &amp;</span>
</pre></div>
</div>
</li>
<li><p class="first">Write sample Python code in sample.py:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>


<span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://www.python.org"</span><span class="p">)</span>
<span class="k">assert</span> <span class="s">"Python"</span> <span class="ow">in</span> <span class="n">driver</span><span class="o">.</span><span class="n">title</span>
<span class="n">elem</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s">"q"</span><span class="p">)</span>
<span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s">"selenium"</span><span class="p">)</span>
<span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">RETURN</span><span class="p">)</span>
<span class="k">assert</span> <span class="s">"Google"</span> <span class="ow">in</span> <span class="n">driver</span><span class="o">.</span><span class="n">title</span>
<span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first">Run sample.py with environment variable DISPLAY=:1:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ DISPLAY=:1 python sample.py</span>
</pre></div>
</div>
</li>
</ol>
]]></description>
             <pubDate>Fri, 09 Aug 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2013/08/05/make_slideshow_gif_using_imagemagick.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2013/08/05/make_slideshow_gif_using_imagemagick.html</guid>
            <title><![CDATA[Make slideshow GIF from a batch of images using ImageMagick]]></title>
            <description><![CDATA[<h1>Make slideshow GIF from a batch of images using ImageMagick</h1>
<ol class="arabic">
<li><p class="first">Download and install ImageMagick Mac OS X Binary Release at ImageMagick official site.</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ tar xvfz ImageMagick-x86_64-apple-darwin12.4.0.tar.gz</span>
<span class="go">$ export MAGICK_HOME="/YOUR/PATH/TO/ImageMagick-6.8.6"</span>
<span class="go">$ export PATH="$MAGICK_HOME/bin:$PATH"</span>
<span class="go">$ export DYLD_LIBRARY_PATH="$MAGICK_HOME/lib/"</span>
</pre></div>
</div>
<p>See this for installation on Linux.</p>
</li>
<li><p class="first">Enter the directory where original images are stored (assuming all files are in .jpg format), use the following command:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ convert -delay 100 -loop 0 -resize 300x225 -quality 90 *.jpg image.gif</span>
</pre></div>
</div>
<p><span class="docutils literal"><span class="pre">-deplay</span></span> represents interval between slides, <span class="docutils literal"><span class="pre">-loop</span></span> indicates number of loops for slide show (0 for infinite loops); other options are intuitive. Note that *.jpg will expand to images ordered alphabetically by filename. Use the following command to re-order the images by last modified time:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ convert -delay 100 -loop 0 -resize 300x225 -quality 90 `ls -t *.jpg` image.gif</span>
</pre></div>
</div>
</li>
</ol>
]]></description>
             <pubDate>Mon, 05 Aug 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2013/07/20/configure_vsftpd_ftp_server_in_active_mode_on_centos.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2013/07/20/configure_vsftpd_ftp_server_in_active_mode_on_centos.html</guid>
            <title><![CDATA[Configure vsftpd FTP server in active mode on CentOS]]></title>
            <description><![CDATA[<h1>Configure vsftpd FTP server in active mode on CentOS</h1>
<ol class="arabic">
<li><p class="first">Install vsftpd, configure SELinux context and start the service:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># yum install vsftpd</span>
<span class="go"># chkconfig vsftpd on</span>
<span class="go"># chcon -R -t public_content_t /var/ftp</span>
<span class="go"># service vsftpd start</span>
</pre></div>
</div>
</li>
<li><p class="first">There are two ways to configure iptables to allow connections</p>
<p>One way is using system-config-firewall, which is simple:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># system-config-firewall-tui</span>
</pre></div>
</div>
<p>Choose FTP in the “Trusted Service” menu and save the configuration. <span class="docutils literal"><span class="pre">system-config-firewall</span></span> will add rule in the INPUT chain and load ip_conntrack_ftp kernel module, which can be verified using:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># lsmod | grep ftp</span>
<span class="go">nf_conntrack_ftp       10475  0</span>
<span class="go">nf_conntrack           65428  4 nf_conntrack_ftp,nf_conntrack_ipv6,nf_conntrack_ipv4,xt_state</span>
</pre></div>
</div>
<p>Another way is do it manually:</p>
<ol class="arabic">
<li><p class="first">Insert the following rule somewhere before the final “reject-with icmp-host-prohibited” rule, say number 4:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># iptables -L --line-numbers</span>
<span class="go"># iptables -I INPUT 4 -p tcp --dport 21 -m state --state NEW -j ACCEPT</span>
</pre></div>
</div>
</li>
<li><p class="first">Load ip_conntrack_ftp (alias of nf_conntrack_ftp):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># modprobe ip_conntrack_ftp</span>
</pre></div>
</div>
<p>Now the FTP directory should be accessible from remote machines.</p>
</li>
</ol>
</li>
</ol>
]]></description>
             <pubDate>Sat, 20 Jul 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2013/07/13/evaluation_criteria_of_computer_science_professional.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2013/07/13/evaluation_criteria_of_computer_science_professional.html</guid>
            <title><![CDATA[Evaluation criteria of computer science professionals]]></title>
            <description><![CDATA[<h1>Evaluation criteria of computer science professionals</h1>
<p>Personal point of view on how to evaluate the generic skills possessed by a computer software professional from a pragmatic perspective without considering specific subdisciplines or academic background in computer science.</p>
<ul class="simple">
<li>Programming Language<ul>
<li>Low-level: C/C++</li>
<li>Object-Oriented: Java/C++/PHP/Python/Ruby</li>
<li>Functional/Scripting: Lisp/Python/Perl/Haskell/Erlang</li>
<li>Web/Mobile: HTML/CSS/JavaScript</li>
</ul>
</li>
<li>System and Network<ul>
<li>System Administration (Unix)</li>
<li>OS/Kernel concept: Process, Memory, I/O</li>
<li>TCP/IP</li>
<li>Basic Scripting: bash/ksh/tcsh/zsh/Perl/Python</li>
</ul>
</li>
<li>Quantitative<ul>
<li>(Discrete) Math</li>
<li>Data Structures and Algorithms</li>
</ul>
</li>
<li>Software/Architecture/Engineering<ul>
<li>Design Pattern</li>
<li>Paradigm: Object-Oriented, Imperative</li>
<li>Purpose:</li>
<li>Low-level: kernel/driver/system/network</li>
<li>Architecture: HPC/HA/Cloud/Cluster/Distributed/Grid</li>
<li>Internet: Web/Mobile</li>
<li>Others: Architecture, Testing, SCM (SVN/Git)</li>
</ul>
</li>
<li>Database<ul>
<li>SQL/NoSQL/Cache</li>
<li>DBMS: MySQL/PostgreSQL/Oracle/MongoDB/…</li>
</ul>
</li>
<li>Conceptions<ul>
<li>Computer Architecture and Hardware</li>
</ul>
</li>
</ul>
]]></description>
             <pubDate>Sat, 13 Jul 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2013/07/11/get_inode_birth_time_os_x_and_bsd.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2013/07/11/get_inode_birth_time_os_x_and_bsd.html</guid>
            <title><![CDATA[Get the inode birth time (crtime or btime) of a file on Mac OS X and BSD descendants]]></title>
            <description><![CDATA[<h1>Get the inode birth time (crtime or btime) of a file on Mac OS X and BSD descendants</h1>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ stat -f "%SB %N" filename.txt</span>
<span class="go">Jul 11 22:27:33 2013 filename.txt</span>
</pre></div>
</div>
<p>According to the man page, <span class="docutils literal"><span class="pre">-f</span></span> is used to display information using the specified format. <span class="docutils literal"><span class="pre">S</span></span> is an optional output format specifier that represents a string output, and <span class="docutils literal"><span class="pre">B</span></span> is a required field specifier that represent the birth time of the inode. <span class="docutils literal"><span class="pre">N</span></span> represents the file name.</p>
]]></description>
             <pubDate>Thu, 11 Jul 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2013/07/02/convert_mysql_engine_from_myisam_to_innodb_django_models.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2013/07/02/convert_mysql_engine_from_myisam_to_innodb_django_models.html</guid>
            <title><![CDATA[Convert MySQL table's engine from MyISAM to InnoDB for Django models]]></title>
            <description><![CDATA[<h1>Convert MySQL table’s engine from MyISAM to InnoDB for Django models</h1>
<p>When I tried using django-activity-stream for my Django project, I cannot use syncdb, so I migrate it using South. When testing something like :</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">actstream</span> <span class="kn">import</span> <span class="n">action</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="s">'tested'</span><span class="p">)</span>
</pre></div>
</div>
<p>I got the following error:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">IntegrityError: (1452, 'Cannot add or update a child row: a</span>
<span class="go">foreign key constraint fails (`alexadb`.`actstream_action`,</span>
<span class="go">CONSTRAINT `actor_content_type_id_refs_id_357b994e` FOREIGN</span>
<span class="go">KEY (`actor_content_type_id`) REFERENCES `django_content_type`</span>
<span class="go">(`id`))')</span>
</pre></div>
</div>
<p>It seems the foreign key constraint fail is related to table <span class="docutils literal"><span class="pre">django_content_type</span></span>. Therefore, I ran the following MySQL command to check the engine of this table:</p>
<div class="highlight-mysql"><div class="highlight"><pre><span class="k">SHOW</span> <span class="k">TABLE</span> <span class="n">STATUS</span> <span class="k">WHERE</span> <span class="n">name</span><span class="o">=</span><span class="s1">'django_content_type'</span><span class="p">;</span>
</pre></div>
</div>
<p>The result for column ‘Engine’ is MyISAM, which is why it does not support foreign key constraint. One solution is to convert it to InnoDB. However, the following MySQL command seems to take a ‘very’ long time (even if it is not a very large table) that I cannot observe for about 5 minutes.</p>
<div class="highlight-mysql"><div class="highlight"><pre><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">django_content_type</span> <span class="kp">ENGINE</span> <span class="o">=</span> <span class="n">InnoDB</span><span class="p">;</span>
</pre></div>
</div>
<p>To make the conversion quicker, I have to use another solution, which is recreating the <span class="docutils literal"><span class="pre">django_content_type</span></span> table with its engine being InnoDB.</p>
<p>This requires the following steps:</p>
<ol class="arabic">
<li><p class="first">In the project directory, dump the app model data associated with table <span class="docutils literal"><span class="pre">django_content_type</span></span>. This app and model name is <span class="docutils literal"><span class="pre">contenttypes.ContentType</span></span> (<span class="docutils literal"><span class="pre">django.contrib.contenttypes.models.ContentType</span></span>).</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ python manage.py dumpdata contenttypes.ContentType &gt; contenttypes.json</span>
</pre></div>
</div>
</li>
<li><p class="first">Drop table <span class="docutils literal"><span class="pre">django_content_type</span></span> in MySQL:</p>
<div class="highlight-mysql"><div class="highlight"><pre><span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">django_content_type</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p class="first">Get SQL statement of model <span class="docutils literal"><span class="pre">contenttypes.ContentType</span></span>:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ python manage.py sqlall contenttypes</span>
<span class="go">BEGIN;</span>
<span class="go">CREATE TABLE `django_content_type` (</span>
<span class="go">    `id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY,</span>
<span class="go">    `name` varchar(100) NOT NULL,</span>
<span class="go">    `app_label` varchar(100) NOT NULL,</span>
<span class="go">    `model` varchar(100) NOT NULL,</span>
<span class="go">    UNIQUE (`app_label`, `model`)</span>
<span class="go">)</span>
<span class="go">;</span>

<span class="go">COMMIT;</span>
</pre></div>
</div>
<p>Add <span class="docutils literal"><span class="pre">Engine=InnoDB</span></span> to the statement, and run this in MySQL:</p>
<div class="highlight-mysql"><div class="highlight"><pre><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="ss">`django_content_type`</span> <span class="p">(</span>
    <span class="ss">`id`</span> <span class="kt">integer</span> <span class="kp">AUTO_INCREMENT</span> <span class="k">NOT</span> <span class="no">NULL</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
    <span class="ss">`name`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="ss">`app_label`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="ss">`model`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="k">UNIQUE</span> <span class="p">(</span><span class="ss">`app_label`</span><span class="p">,</span> <span class="ss">`model`</span><span class="p">)</span>
<span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span>
<span class="p">;</span>
</pre></div>
</div>
</li>
<li><p class="first">Load dumped data into database:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ python manage.py loaddata contenttypes.json</span>
</pre></div>
</div>
</li>
<li><p class="first">Finally, the testing of django-activity-stream should work without errors:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">myapp.models</span> <span class="kn">import</span> <span class="n">Foo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Foo</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">actstream</span> <span class="kn">import</span> <span class="n">action</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="s">'tested'</span><span class="p">)</span>
<span class="go">[(&lt;function action_handler at 0x1102ff410&gt;, None)]</span>
</pre></div>
</div>
</li>
</ol>
]]></description>
             <pubDate>Tue, 02 Jul 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2013/06/30/add_static_route_on_mac_osx_and_bsd.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2013/06/30/add_static_route_on_mac_osx_and_bsd.html</guid>
            <title><![CDATA[Add static routes on Mac OS X and BSD descendants]]></title>
            <description><![CDATA[<h1>Add static routes on Mac OS X and BSD descendants</h1>
<p>Add a static route:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># route -n add -net 192.168.122.0/24  192.168.0.117</span>
</pre></div>
</div>
<p>This is equivalent to the Linux command:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># route add -net 192.168.122.0 netmask 255.255.255.0 gw 192.168.0.117</span>
</pre></div>
</div>
<p>List routing tables:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># netstat -r</span>
</pre></div>
</div>
]]></description>
             <pubDate>Sun, 30 Jun 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2013/03/29/su_sudo_and_environment.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2013/03/29/su_sudo_and_environment.html</guid>
            <title><![CDATA[su, sudo, and environment]]></title>
            <description><![CDATA[<h1>su, sudo, and environment</h1>
<ol class="arabic">
<li><p class="first"><strong>sudo -i</strong></p>
<p><span class="docutils literal"><span class="pre">sudo</span> <span class="pre">-i</span> <span class="pre">[command]</span></span>
If command is omitted, it spawns a login shell of the target user (usually root) modifying the environment. Otherwise, the command is passed to the shell for execution.</p>
</li>
<li><p class="first"><strong>sudo -s</strong></p>
<p><span class="docutils literal"><span class="pre">sudo</span> <span class="pre">-s</span> <span class="pre">[command]</span></span></p>
<p>If command is omitted, it spawns spawns a login shell of the target user (usually root) without modifying the environment. Otherwise, the command is passed to the shell for execution.</p>
<p>This command is useful if you want to keep the environment variables (such as <span class="docutils literal"><span class="pre">HISTFILE</span></span> for history) when executing sudo. Use <span class="docutils literal"><span class="pre">env</span></span> or <span class="docutils literal"><span class="pre">declare</span></span> to see the environment.</p>
<p>Note that if <span class="docutils literal"><span class="pre">always_set_home</span></span> is enabled in <span class="docutils literal"><span class="pre">/etc/sudoers</span></span> (with a line <span class="docutils literal"><span class="pre">Defaults</span> <span class="pre">always_set_home</span></span>), after you execute <span class="docutils literal"><span class="pre">sudo</span> <span class="pre">-s</span></span>, the <span class="docutils literal"><span class="pre">HOME</span></span> will be changed to the homedir of the target user, as if you execute <span class="docutils literal"><span class="pre">sudo</span> <span class="pre">-sH</span></span>.</p>
</li>
<li><p class="first"><strong>sudo bash -c</strong></p>
<p><span class="docutils literal"><span class="pre">sudo</span> <span class="pre">bash</span> <span class="pre">-c</span> <span class="pre">'command</span> <span class="pre">string'</span></span></p>
<p>As a regular user, the following command will fail:</p>
<p><span class="docutils literal"><span class="pre">sudo</span> <span class="pre">ls</span> <span class="pre">&gt;</span> <span class="pre">/root/ls.txt</span></span></p>
<p>Because although the shell that sudo spawns executes ls with root privileges, the non-privileged shell that the user is running redirects the output.</p>
<p>As a solution, use the following command:</p>
<p><span class="docutils literal"><span class="pre">sudo</span> <span class="pre">bash</span> <span class="pre">-c</span> <span class="pre">'ls</span> <span class="pre">&gt;</span> <span class="pre">/root/ls.txt'</span></span></p>
<p><span class="docutils literal"><span class="pre">bash</span> <span class="pre">-c</span></span> spawns a shell that executes the string following the option and then terminates. The sudo utility runs the spawned shell with root privileges (without modifying environment).</p>
</li>
<li><p class="first"><strong>su -c</strong></p>
<p><span class="docutils literal"><span class="pre">su</span> <span class="pre">-c</span> <span class="pre">'command</span> <span class="pre">string'</span></span></p>
<p>Similar to the previous one, <span class="docutils literal"><span class="pre">su</span> <span class="pre">-c</span></span> runs a command with root privileges and returna to original shell after execution.</p>
<p>For example,</p>
<p><span class="docutils literal"><span class="pre">su</span> <span class="pre">-c</span> <span class="pre">'ls</span> <span class="pre">&gt;</span> <span class="pre">/root/ls.txt'</span></span></p>
<p>In conclusion, 1, 2 and 3 uses sudo utility to execute single commands and have the advantage of not requiring root password.</p>
</li>
</ol>
<p>Reference:</p>
<p>Mark G. Sobell. A Practical Guide to Ubuntu Linux, Third Edition. 2010</p>
]]></description>
             <pubDate>Fri, 29 Mar 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao-an.info/blog/html/2013/03/19/create_a_personal_website_with_sphinx.html</link>
            <guid>http://blog.shichao-an.info/blog/html/2013/03/19/create_a_personal_website_with_sphinx.html</guid>
            <title><![CDATA[Create a personal website with Sphinx]]></title>
            <description><![CDATA[<h1>Create a personal website with Sphinx</h1>
<p>Sphinx is a documentation generator which converts reStructuredText files into HTML websites and other formats e.g. LaTeX (PDF) and man pages. It’s also a good idea to create simple static website with Sphinx, for example, a personal profile site.</p>
<p>However, as the default purpose of Sphinx is to create documentation, it requires some customization regarding template structure and style. The following steps help create a simple profile site based on the built-in themes of Sphinx.</p>
<ol class="arabic">
<li><p class="first">Download <a class="reference external" href="http://sphinx-doc.org/index.html">Sphinx</a>, create a base directory and quick-start Sphinx. It’ll be helpful to answer “yes” to “Create Makefile?” during sphinx-quickstart:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ easy_install -U sphinx</span>
<span class="go">$ mkdir base_dir</span>
<span class="go">$ cd base_dir</span>
<span class="go">$ sphinx-quickstart</span>
</pre></div>
</div>
</li>
<li><p class="first">Change site title.</p>
<p>Edit <span class="docutils literal"><span class="pre">conf.py</span></span> in the source directory and make the following modifications:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">html_title</span> <span class="o">=</span> <span class="s">"YOUR SITE TITLE"</span>
<span class="c">#version = '0.0.1'</span>
<span class="c">#release = '0.0.1'</span>
</pre></div>
</div>
<p>Comment version and release to prevent this version number from being displayed in titles.</p>
</li>
<li><p class="first">Customize the content structure based on “basic” theme or its derivatives (“default” and “nature”). We take “nature” as an example here.</p>
<p>First, edit <span class="docutils literal"><span class="pre">conf.py</span></span> and make the following modifications:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">html_theme</span> <span class="o">=</span> <span class="s">'nature'</span>
<span class="n">html_sidebars</span> <span class="o">=</span> <span class="p">{</span><span class="s">'**'</span><span class="p">:[</span><span class="s">'localtoc.html'</span><span class="p">,</span><span class="s">'searchbox.html'</span><span class="p">]}</span>
</pre></div>
</div>
<p><span class="docutils literal"><span class="pre">html_sidebars</span></span> determines the built-in templates to be displayed in the sidebar. For other built-in templates and detailed information, see <span class="docutils literal"><span class="pre">html_sidebars</span></span>.</p>
<p>Second, make sure the settings of the following variables:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">templates_path</span> <span class="o">=</span> <span class="p">[</span><span class="s">'_templates'</span><span class="p">]</span>
<span class="n">html_static_path</span> <span class="o">=</span> <span class="p">[</span><span class="s">'_static'</span><span class="p">]</span>
</pre></div>
</div>
<p><span class="docutils literal"><span class="pre">_templates</span></span> directory stores template files; _static directory stores static files such as CSS and images. These two directories reside in source directory.</p>
<p>Third, create your own template <span class="docutils literal"><span class="pre">layout.html</span></span> inheriting from the default theme:</p>
<div class="highlight-python"><div class="highlight"><pre>$ cd source/_template
$ vi layout.html
</pre></div>
</div>
<p>Edit layout.html:</p>
<div class="highlight-jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">"!layout.html"</span> <span class="cp">%}</span><span class="x"/>
<span class="cp">{%</span>- <span class="k">set</span> <span class="nv">rellinks</span> <span class="o">=</span> <span class="o">[]</span> <span class="cp">%}</span><span class="x"/>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">rootrellink</span> <span class="cp">%}</span><span class="x">&lt;/pre&gt;</span>
<span class="x">&lt;ul&gt;</span>
<span class="x">    &lt;li&gt;&lt;a href="index.html"&gt;Home&lt;/a&gt; |&lt;/li&gt;</span>
<span class="x">    &lt;li&gt;&lt;a href="resume.html"&gt;Resume&lt;/a&gt; |&lt;/li&gt;</span>
<span class="x">    &lt;li&gt;&lt;a href="projects.html"&gt;Projects&lt;/a&gt; |&lt;/li&gt;</span>
<span class="x">    &lt;li&gt;&lt;a href="interest.html"&gt;Interest&lt;/a&gt; |&lt;/li&gt;</span>
<span class="x">    &lt;li&gt;&lt;a href="contact.html"&gt;Contact&lt;/a&gt;&lt;/li&gt;</span>
<span class="x">    &lt;li&gt;</span><span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x"/>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">relbar2</span> <span class="cp">%}</span><span class="x"/>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x"/>
<span class="x">The template above creates a header navigation bar of different entries of your sites.</span>

<span class="cp">{%</span>- <span class="k">set</span> <span class="nv">rellinks</span> <span class="o">=</span> <span class="o">[]</span> <span class="cp">%}</span><span class="x"> disables related links (i.e. prev, next and index).</span>
</pre></div>
</div>
</li>
<li><p class="first">Create reStructuredText (.rst) source files for your entries (<span class="docutils literal"><span class="pre">index.html</span></span>, <span class="docutils literal"><span class="pre">resume.html</span></span>, <span class="docutils literal"><span class="pre">projects.html</span></span>, <span class="docutils literal"><span class="pre">interest.html</span></span>, <span class="docutils literal"><span class="pre">contact.html</span></span>):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ cd source</span>
<span class="go">$ vi index.rst</span>
</pre></div>
</div>
<p>Use the following format, which also applies to other .rst files, such as <span class="docutils literal"><span class="pre">resume.rst</span></span>, <span class="docutils literal"><span class="pre">projects.rst</span></span>, <span class="docutils literal"><span class="pre">interest.html</span></span> and <span class="docutils literal"><span class="pre">contact.html</span></span>.</p>
<div class="highlight-rst"><div class="highlight"><pre><span class="gh">Welcome</span>
<span class="gh">*******</span>
Welcome to my site!

<span class="gh">About me</span>
<span class="gh">========</span>
I am Blah Blah ...

<span class="gh">More info</span>
<span class="gh">=========</span>
Blah...

<span class="p">..</span> <span class="ow">toctree</span><span class="p">::</span>
   <span class="nc">:maxdepth:</span> <span class="nf">2</span>
</pre></div>
</div>
</li>
<li><p class="first">Add a logo for your site.</p>
<p>First, copy your logo image to the <span class="docutils literal"><span class="pre">source/_static</span></span> directory.</p>
<p>Then, edit <span class="docutils literal"><span class="pre">conf.py</span></span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">html_logo</span> <span class="o">=</span> <span class="s">"logo.jpg"</span>
</pre></div>
</div>
</li>
<li><p class="first">Modify style sheets.</p>
<p>First, edit <span class="docutils literal"><span class="pre">conf.py</span></span> and specify your CSS file name:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">html_style</span> <span class="o">=</span> <span class="s">"mystyle.css"</span>
</pre></div>
</div>
<p>Second, create your CSS file the <span class="docutils literal"><span class="pre">source/_static</span></span> directory:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ cd source/_static</span>
<span class="go">$ vi mystyle.css</span>
</pre></div>
</div>
<p>Then, edit your CSS file by inheriting default theme CSS, <span class="docutils literal"><span class="pre">nature.css</span></span> in our example.</p>
<div class="highlight-css"><div class="highlight"><pre><span class="k">@import</span> <span class="nt">url</span><span class="o">(</span><span class="s2">"nature.css"</span><span class="o">)</span><span class="p">;</span>

<span class="nt">body</span> <span class="p">{</span>
  <span class="k">font-family</span><span class="o">:</span> <span class="s2">"Helvetica Neue"</span><span class="o">,</span> <span class="n">Helvetica</span><span class="o">,</span> <span class="n">Arial</span><span class="o">,</span> <span class="k">sans-serif</span><span class="p">;</span>
  <span class="k">font-size</span><span class="o">:</span> <span class="m">14px</span><span class="p">;</span>
  <span class="k">font-weight</span><span class="o">:</span> <span class="m">300</span><span class="p">;</span>
  <span class="k">background-color</span><span class="o">:</span><span class="m">#333</span><span class="p">;</span>

<span class="p">}</span>

<span class="nt">div</span><span class="nc">.sphinxsidebar</span> <span class="p">{</span>
  <span class="k">font-size</span><span class="o">:</span> <span class="m">0.9em</span><span class="p">;</span>
  <span class="k">line-height</span><span class="o">:</span> <span class="m">1.5em</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">div</span><span class="nc">.sphinxsidebarwrapper</span><span class="p">{</span>
  <span class="k">margin-left</span><span class="o">:</span><span class="m">10px</span><span class="p">;</span>
  <span class="k">padding</span><span class="o">:</span> <span class="m">5px</span> <span class="m">0</span> <span class="m">10px</span> <span class="m">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">div</span><span class="nc">.related</span> <span class="p">{</span>
  <span class="k">background-color</span><span class="o">:</span><span class="m">#5F95CE</span><span class="p">;</span>
  <span class="k">font-size</span><span class="o">:</span> <span class="m">1em</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p class="first">Build your source files from <span class="docutils literal"><span class="pre">base_dir</span></span>.</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ make html</span>
<span class="go">$ sphinx-build -b html -d build/doctrees source build/html</span>
</pre></div>
</div>
<p>Use the following commands if your modification to CSS files does not take effect</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sphinx-build -a -b html -d build/doctrees source build/html</span>
</pre></div>
</div>
</li>
<li><p class="first">Finish. HTML files are generated in <span class="docutils literal"><span class="pre">build/html</span></span>, and your site is ready to be visited.</p>
</li>
</ol>
]]></description>
             <pubDate>Tue, 19 Mar 2013 00:00:00 -0700</pubDate>
        </item>
    
    </channel>
</rss>