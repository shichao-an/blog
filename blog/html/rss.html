<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
    <channel>
        <title>Shichao's Blog</title>
        <link>http://blog.shichao.io/blog/html/</link>
        <description>Recording molecular stuff</description>
        <language>en-us</language>
        <pubDate>Wed, 01 Oct 2014 00:00:00 -0700</pubDate>
        
        <item>
            <link>http://blog.shichao.io/blog/html/2014/10/01/setup_virtualenvwrapper_with_pyenv_using_pyenv_virtualenvwrapper.html</link>
            <guid>http://blog.shichao.io/blog/html/2014/10/01/setup_virtualenvwrapper_with_pyenv_using_pyenv_virtualenvwrapper.html</guid>
            <title><![CDATA[Setup virtualenvwrapper with pyenv using pyenv-virtualenvwrapper]]></title>
            <description><![CDATA[<h1>Setup virtualenvwrapper with pyenv using pyenv-virtualenvwrapper</h1>
<p>Typically on OS X, I’m prone to use <a class="reference external" href="https://github.com/yyuu/pyenv">pyenv</a> to manage multiple Python versions, particularly 2.7 and 3.3. I always keep the 2.7.x Python (system version) that ships with OS X, and install extra versions using pyenv, and develop under virtualenvs. It seems <a class="reference external" href="https://github.com/pypa/virtualenv">virtualenv</a> and <a class="reference external" href="https://bitbucket.org/dhellmann/virtualenvwrapper">virtualenvwrapper</a> do not natively work well with pyenv’s shims when creating new virtualenvs, and it also seems the author of pyenv already gives the solution, <a class="reference external" href="https://github.com/yyuu/pyenv-virtualenvwrapper">pyenv-virtualenvwrapper</a>.</p>
<p>As an essential record, install Python 3.4.1 using pyenv (for installation of pyenv itself, see its <a class="reference external" href="https://github.com/yyuu/pyenv">documentation</a>) and enable it globally, along with the system version.</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ pyenv install 3.4.1</span>
<span class="go">$ pyenv rehash</span>
<span class="go">$ pyenv global system 3.4.1</span>
</pre></div>
</div>
<p>You can verify current available versions using the following command:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ pyenv versions</span>
<span class="go">* system (set by /Users/shichao/.python-version)</span>
<span class="go">* 3.4.1 (set by /Users/shichao/.python-version)</span>
</pre></div>
</div>
<p>Make sure you have installed virtualenvwrapper and pyenv-virtualenvwrapper (using brew, of course):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ pip install virtualenvwrapper</span>
<span class="go">$ brew install pyenv-virtualenvwrapper</span>
</pre></div>
</div>
<p>Then, put the following lines somewhere in your <span class="docutils literal"><span class="pre">~/.bash_profile</span></span>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="c"># pyenv</span>
<span class="nb">eval</span> <span class="s2">"$(pyenv init -)"</span>
<span class="c"># virtualenvwrapper</span>
<span class="nb">export </span><span class="nv">WORKON_HOME</span><span class="o">=</span>~/envs
</pre></div>
</div>
<p>Then you can enable virtualenvwrapper with <span class="docutils literal"><span class="pre">pyenv</span> <span class="pre">virtualenvwrapper</span></span>, and you may set an alias for that.</p>
<p>Now, you can normally create new virtualenvs.</p>
<p>Create a virtualenv from the system version:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ mkvirtualenv env1 -p $(which python)</span>
</pre></div>
</div>
<p>Similarly, create a virtualenv from 3.4:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ mkvirtualenv env2 -p $(which python3.4)</span>
</pre></div>
</div>
]]></description>
             <pubDate>Wed, 01 Oct 2014 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2014/05/02/fixing_mongodb_against_unclean_shutdown.html</link>
            <guid>http://blog.shichao.io/blog/html/2014/05/02/fixing_mongodb_against_unclean_shutdown.html</guid>
            <title><![CDATA[Fixing MongoDB against unclean shutdown]]></title>
            <description><![CDATA[<h1>Fixing MongoDB against unclean shutdown</h1>
<p>It’s been a while since I maintained one of my servers that host an old project. After I got an HTTP 500 in an occasional case, I logged in to check what happened, only to find MongoDB is down. Running <span class="docutils literal"><span class="pre">service</span> <span class="pre">mongod</span> <span class="pre">restart</span></span> does not work. The MongoDB log indicates “Unclean shutdown detected.”</p>
<p>After a search on Google, here’s what I did to fix that:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># grep dbpath /etc/mongod.conf</span>
<span class="go">dbpath=/var/lib/mongo</span>
<span class="go"># rm /var/lib/mongo/mongod.lock</span>
<span class="go"># mongod --repair --dbpath /var/lib/mongo</span>
</pre></div>
</div>
<p>At this point, you will see that MongoDB is running the repair process. If you immediately start MongoDB server after that, it still fails, because some permissions in /var/lib/mongo have been changed. You have to recover owner and group of those files back to “mongod” and then start the service:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># chown -R mongod:mongod /var/lib/mongo</span>
<span class="go"># service mongod restart</span>
</pre></div>
</div>
<p>Finally note that this is an CentOS server. If you use MongoDB on Ubuntu, some namings may be different.</p>
]]></description>
             <pubDate>Fri, 02 May 2014 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2014/05/01/get_number_of_bits_of_a_python_integer.html</link>
            <guid>http://blog.shichao.io/blog/html/2014/05/01/get_number_of_bits_of_a_python_integer.html</guid>
            <title><![CDATA[Get number of bits of a Python integer]]></title>
            <description><![CDATA[<h1>Get number of bits of a Python integer</h1>
<p>A Python integer is represented as either of 32-bit or 64-bit signed integer type that is platform-specific, without considering it as <a class="reference external" href="https://docs.python.org/2.7/c-api/int.html">an Python object</a>. As indicated in the documentation, whether it is 32-bit or 64-bit can be revealed by checking <span class="docutils literal"><span class="pre">sys.maxsize</span></span> (or <span class="docutils literal"><span class="pre">sys.maxint</span></span> on older CPython implementations such as 2.4), the value of which “is the largest positive integer supported by the platform’s <span class="docutils literal"><span class="pre">Py_ssize_t</span></span> type and is usually <span class="docutils literal"><span class="pre">2**31</span> <span class="pre">-</span> <span class="pre">1</span></span> on a 32-bit platform and <span class="docutils literal"><span class="pre">2**63</span> <span class="pre">-</span> <span class="pre">1</span></span> on a 64-bit platform”. <a class="reference external" href="https://docs.python.org/2/library/sys.html">[1]</a> <a class="reference external" href="https://docs.python.org/3/library/sys.html#sys.maxsize">[2]</a>.</p>
<p>The following function helps determine number of bits of an integer and returns either 64 or 32 by leveraging the variable discussed above:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>


<span class="k">def</span> <span class="nf">get_int_bits</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">'maxsize'</span><span class="p">):</span>
        <span class="n">max_int</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">'maxsize'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">max_int</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">'maxint'</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">max_int</span> <span class="o">&gt;&gt;</span> <span class="mi">62</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">32</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">64</span>
</pre></div>
</div>
<p>Check out the code on GitHub Gist from <a class="reference external" href="https://gist.github.com/shichao-an/b447d24f0a5381b0fa92">this link</a>.</p>
<p><strong>Updated Jun 10, 2014</strong></p>
<p>After an exploration of the <a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#int.bit_length">built-in types</a>, it is clear that <span class="docutils literal"><span class="pre">int.bit_length</span></span> can be used more easily than bit manipulation.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>


<span class="k">def</span> <span class="nf">get_int_bits</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">'maxsize'</span><span class="p">):</span>
        <span class="n">max_int</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">'maxsize'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">max_int</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="s">'maxint'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">max_int</span><span class="o">.</span><span class="n">bit_length</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
]]></description>
             <pubDate>Thu, 01 May 2014 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2014/04/09/using_bash_arrays_and_ifs_to_manipulate_filenames.html</link>
            <guid>http://blog.shichao.io/blog/html/2014/04/09/using_bash_arrays_and_ifs_to_manipulate_filenames.html</guid>
            <title><![CDATA[Using Bash arrays and IFS to manipulate filenames]]></title>
            <description><![CDATA[<h1>Using Bash arrays and IFS to manipulate filenames</h1>
<p>Assume we want to work with files in a directory. The most intuitive way is to make use of filename expansion, using globbing. We can use the <cite>for construct</cite> and wildcard <span class="docutils literal"><span class="pre">*</span></span> to handle each file nice and clean, without worrying about those filenames that contain whitespaces (suppose that in all of the following context, the working directory contain three files: “Foo”, “Bar”, and “Foo Bar”):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ for file in *; do echo "$file"; done</span>
</pre></div>
</div>
<p>We can also create an array from these filenames, using the following command:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ files=(*)</span>
</pre></div>
</div>
<p>Then, we can take a look at both the attributes and the value of <cite>files</cite>:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ declare -p files</span>
<span class="go">declare -a files='([0]="Bar" [1]="Foo" [2]="Foo Bar")'</span>
</pre></div>
</div>
<p>What if we want to create an array with specific orders, say by modification time (<cite>mtime</cite>) of files. We have to use the <span class="docutils literal"><span class="pre">ls</span></span> with the <span class="docutils literal"><span class="pre">-t</span></span> switch.  Now there are several practical scenarios discussed as follows.</p>
<ol class="arabic">
<li><p class="first">Get the latest modified filename:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ filename=$(ls -t | head -1)</span>
</pre></div>
</div>
</li>
<li><p class="first">Create an array of filenames ordered by their <cite>mtime</cite>. Clearly, globbing will not work because it is based on filename pattern matching. We have to use both command substitution and word splitting. Let’s try the following first:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ filenames=($(ls -t))</span>
<span class="go">$ declare -p filenames</span>
<span class="go">declare -a filenames='([0]="Foo" [1]="Bar" [2]="Bar" [3]="Foo")'</span>
</pre></div>
</div>
<p>Clearly this is not the result we want since the whitespace-contained filename is corrupted.</p>
<p>We need to hack a little on IFS variable. Let’s try what happens if we disable word splitting by setting IFS to null:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ IFS=</span>
<span class="go">$ filenames=($(ls -t))</span>
<span class="go">$ declare -p filenames</span>
<span class="go">declare -a filenames='([0]="Foo Bar</span>
<span class="go">Bar</span>
<span class="go">Foo")'</span>
</pre></div>
</div>
<p>It seems it’s getting worse this time. Since word splitting is not performed, the result of command substitution becomes an single word.</p>
<p>We know that the result of <span class="docutils literal"><span class="pre">ls</span></span> command is multiple lines of filenames. As the result of command substitution (i.e. <span class="docutils literal"><span class="pre">$(ls</span> <span class="pre">-t)</span></span>), the filenames are separated by newlines (<span class="docutils literal"><span class="pre">\n</span></span>). The default IFS is a sequence of <span class="docutils literal"><span class="pre">\t\n</span></span> (space, tab and newline), which means each of these characters will be used to delimit words. Here we need to suppress the effect of space; just set IFS to newline character (<span class="docutils literal"><span class="pre">\n</span></span>) (as long as your filenames does not contain newlines), with ANSI C quoting (<span class="docutils literal"><span class="pre">$''</span></span>):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ IFS=$'\n'</span>
<span class="go">$ filenames=($(ls -t))</span>
<span class="go">$ declare -p filenames</span>
<span class="go">declare -a filenames='([0]="Foo Bar" [1]="Bar" [2]="Foo")'</span>
</pre></div>
</div>
<p>In similar ways, we can get <cite>n</cite> most recently modified filenames, just make use of parameter expansion:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ echo "${filenames[@]:0:2}"  # Print two most recently modified names</span>
</pre></div>
</div>
</li>
</ol>
]]></description>
             <pubDate>Wed, 09 Apr 2014 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2014/04/04/bash_double_bracket_test_contructs_and_word_splitting.html</link>
            <guid>http://blog.shichao.io/blog/html/2014/04/04/bash_double_bracket_test_contructs_and_word_splitting.html</guid>
            <title><![CDATA[Bash double brackets, test contructs and word splitting]]></title>
            <description><![CDATA[<h1>Bash double brackets, test contructs and word splitting</h1>
<p>We know that the double brackets constructs can be used in place of the <span class="docutils literal"><span class="pre">test</span></span> builtin (<span class="docutils literal"><span class="pre">[</span></span>) commonly used as single brackets to evaluate conditional expressions. The double brackets are preferred in terms of writing less error-prone scripts, though it is not POSIX-compliant (not portable to many other shells).</p>
<p>The primary difference of double brackets from the <span class="docutils literal"><span class="pre">test</span></span> builtin is that word splitting and filename expansion are not performed within them. It is easier to understand the filename expansion difference in this case, let’s take a look at the difference of word splitting.</p>
<ol class="arabic">
<li><p class="first">First, the following command fails because in <span class="docutils literal"><span class="pre">test</span></span> constructs the word splitting is performed after parameter expansion (and variable expansion, if any):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ bash -xc 'foobar="hello world"; [ $foobar = "hello world" ] &amp;&amp; echo "yes"'</span>
<span class="go">+ '[' hello world = 'hello world' ']'</span>
<span class="go">bash: line 0: [: too many arguments</span>
</pre></div>
</div>
</li>
<li><p class="first">In the double brackes, the error will not occur because word splitting is not performed, like the following:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ bash -xc 'foobar="hello world"; [[ $foobar = "hello world" ]] &amp;&amp; echo "yes"'</span>
<span class="go">+ foobar='hello world'</span>
<span class="go">+ [[ hello world = \h\e\l\l\o\ \w\o\r\l\d ]]</span>
<span class="go">+ echo yes</span>
<span class="go">yes</span>
</pre></div>
</div>
</li>
<li><p class="first">We can supress word splitting in the <span class="docutils literal"><span class="pre">test</span></span> construct by setting IFS to null, because when IFS is null, word splitting never occurs. This time, this command will succeed:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ bash -xc 'IFS=""; foobar="hello world"; [ $foobar = "hello world" ] &amp;&amp; echo "yes"'</span>
<span class="go">+ IFS=</span>
<span class="go">+ foobar='hello world'</span>
<span class="go">+ '[' 'hello world' = 'hello world' ']'</span>
<span class="go">+ echo yes</span>
<span class="go">yes</span>
</pre></div>
</div>
</li>
<li><p class="first">Another feature to note is that double brackets treat unset variables and null variable (variable whose value is a null string, i.e. ‘’)  differently from the <span class="docutils literal"><span class="pre">test</span></span> construct. For example:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ bash -xc 'IFS=""; foobar=""; [ $foobar = "hello world" ] &amp;&amp; echo "yes"'</span>
<span class="go">+ IFS=</span>
<span class="go">+ foobar=</span>
<span class="go">+ '[' = 'hello world' ']'</span>
<span class="go">bash: line 0: [: =: unary operator expected</span>

<span class="go">$ bash -xc 'IFS=""; foobar=""; [[ $foobar = "hello world" ]] &amp;&amp; echo "yes"'</span>
<span class="go">+ IFS=</span>
<span class="go">+ foobar=</span>
<span class="go">+ [[ '' = \h\e\l\l\o\ \w\o\r\l\d ]]</span>
</pre></div>
</div>
</li>
</ol>
<p>The unset or null variable is converted to null argument (<span class="docutils literal"><span class="pre">''</span></span>) as a result in double brackets, while in <span class="docutils literal"><span class="pre">test</span></span> constructs it is removed.</p>
<ol class="arabic" start="5">
<li><p class="first">You may notice in the second step above that the xtrace output of the conditional expression to the right of the operator is <span class="docutils literal"><span class="pre">\h\e\l\l\o\</span> <span class="pre">\w\o\r\l\d</span></span>. This is because when using operators <span class="docutils literal"><span class="pre">==</span></span>, <span class="docutils literal"><span class="pre">!=</span></span> and the POSIX version <span class="docutils literal"><span class="pre">=</span></span>, the string to the right is considered a pattern and pattern matching will be performed. The backslash indicates the each character is literal instead of pattern, because “hello world” is quoted. The following example makes the right string as pattern:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ bash -xc 'IFS=""; foobar="hello world"; [[ $foobar = hello* ]] &amp;&amp; echo "yes"'</span>
<span class="go">+ IFS=</span>
<span class="go">+ foobar='hello world'</span>
<span class="go">+ [[ hello world = hello* ]]</span>
<span class="go">+ echo yes</span>
<span class="go">yes</span>
</pre></div>
</div>
</li>
</ol>
]]></description>
             <pubDate>Fri, 04 Apr 2014 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2014/03/20/enabling_adobe_flash_player_plugin_for_google_chrome_on_fedora.html</link>
            <guid>http://blog.shichao.io/blog/html/2014/03/20/enabling_adobe_flash_player_plugin_for_google_chrome_on_fedora.html</guid>
            <title><![CDATA[Enabling Adobe Flash Player plugin for Google Chrome on Fedora]]></title>
            <description><![CDATA[<h1>Enabling Adobe Flash Player plugin for Google Chrome on Fedora</h1>
<p>The Google Chrome browser I use was installed from the third-party repository by Google. The default Pepper Flash Player plugin (version 12.0) does not support some websites (such as <a class="reference external" href="http://www.bilibili.tv">www.bilibili.tv</a>). I have to install the Adobe Flash Player plugin and enable it for Google Chrome.</p>
<p>1. Install the repository from Adobe (assuming 64-bit):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># yum install http://linuxdownload.adobe.com/adobe-release/adobe-release-x86_64-1.0-1.noarch.rpm</span>
<span class="go"># rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-adobe-linux</span>
</pre></div>
</div>
<p>2. Install the flash-plugin package:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># yum install flash-plugin</span>
</pre></div>
</div>
<p>3. Create symbolic link at Google Chrome’s default directory:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># ln -s /usr/lib64/mozilla/plugins/libflashplayer.so /opt/google/chrome/libflashplayer.so</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li>Restart Google Chrome, go to “<a class="reference external" href="about:plugins">about:plugins</a>” page, toggle “Details” switch at upper right corner, disable PepperFlash plugin and enable the Adobe Flash Player plugin with location “/usr/lib64/flash-plugin/libflashplayer.so”</li>
</ol>
]]></description>
             <pubDate>Thu, 20 Mar 2014 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2014/03/17/setuid_and_uid_euid_and_suid.html</link>
            <guid>http://blog.shichao.io/blog/html/2014/03/17/setuid_and_uid_euid_and_suid.html</guid>
            <title><![CDATA[setuid() and uid, euid and suid]]></title>
            <description><![CDATA[<h1>setuid() and uid, euid and suid</h1>
<p>We know that <cite>setuid</cite> bit allows a program to change its effective uid (euid) upon execution. I want to take a look at how <cite>setuid()</cite> system call works through the following experiment.</p>
<p>Open a terminal session and run the <span class="docutils literal"><span class="pre">passwd</span></span> command (a known <cite>setuid</cite> executable) in the background (it will be suspended with a “[stopped]” output because it requires password from stdin) and get its PID (let’s assume it’s 10401) with <span class="docutils literal"><span class="pre">echo</span> <span class="pre">$!</span></span>:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ passwd &amp;</span>
<span class="go">$ echo $!  # 10401</span>
</pre></div>
</div>
<p>Then, run <span class="docutils literal"><span class="pre">gdb</span></span> to attach to this process:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo gdb -p $!</span>
</pre></div>
</div>
<p>Open another terminal, the run the following command to get the line that represents the current real UID (<cite>uid</cite>), effective UID (<cite>euid</cite>), saved UID (<cite>suid</cite>) and file system UID (<cite>fsuid</cite>) of the previous <span class="docutils literal"><span class="pre">passwd</span></span> process:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ watch -n 1 grep -i 'uid' /proc/10401/task/10401/status</span>
<span class="go">Uid:    1000    0       0   0</span>
</pre></div>
</div>
<p>In the first terminal, you can call <cite>seteuid(1000)</cite> to change its <cite>euid</cite> to 1000:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">(gdb) call seteuid(1000)</span>
<span class="go">$1 = 0</span>
</pre></div>
</div>
<p>Then the output of the <span class="docutils literal"><span class="pre">watch</span></span> command will become:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">Uid:    1000    1000    0   1000</span>
</pre></div>
</div>
<p>As you see the <cite>euid</cite> is 1000 and the process becomes unprivileged. With the following command, you will notice that the USER field has been changed to the regular user instead of root:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ ps -u -p 10401</span>
</pre></div>
</div>
<p class="readmorewrapper"><a class="readmore" href="http://blog.shichao.io/blog/html/2014/03/17/setuid_and_uid_euid_and_suid.html#more">Read more...</a></p> 
 
 
 
 
]]></description>
             <pubDate>Mon, 17 Mar 2014 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2014/03/05/suppressing_fedora.html</link>
            <guid>http://blog.shichao.io/blog/html/2014/03/05/suppressing_fedora.html</guid>
            <title><![CDATA[Suppressing Fedora NetworkManager's prompt to connect to WPA Enterprise wireless networks]]></title>
            <description><![CDATA[<h1>Suppressing Fedora NetworkManager’s prompt to connect to WPA Enterprise wireless networks</h1>
<p>This seems to be an unsolved bug (<a class="reference external" href="https://bugzilla.redhat.com/show_bug.cgi?id=982429">#982429</a>) still under discussion. Many give temporary solutions that modify the corresponding <span class="docutils literal"><span class="pre">ifcfg-*</span></span> file and specify the password, possibly in plaintext form. Some suggest encrypting the password using <span class="docutils literal"><span class="pre">wpa_passphrase</span> <span class="pre">ESSID</span></span> command. The problematic network here is “nyu” of the New York University. Every time I turned on my laptop on the campus, it prompts with a dialog (though the password is actually stored) for me to click the “Connect” button, which is annoying. However, the encryption method does not work as far as I am concerned with Fedora 20. So I just followed the plaintext way to produce a temporary fix for that::</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># cd /etc/sysconfig/network-scripts</span>
<span class="go"># vim ifcfg-nyu</span>
</pre></div>
</div>
<p>Comment or remove the following line:</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="na">IEEE_8021X_PASSWORD_FLAGS</span><span class="o">=</span><span class="s">user</span>
</pre></div>
</div>
<p>Create a new file named <span class="docutils literal"><span class="pre">keys-nyu</span></span> in this directory with your password:</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="na">IEEE_8021X_PASSWORD</span><span class="o">=</span><span class="s">'your_password'</span>
</pre></div>
</div>
<p>Don’t forget to make it read-writable by root only:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># chmod 600 keys-nyu</span>
</pre></div>
</div>
<p>Then restart your network interface associated with “nyu”::</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># ifdown nyu</span>
<span class="go"># ifup nyu</span>
</pre></div>
</div>
<p>Then, the wireless network should work as expected. Try to logout or reboot to see if it surely works.</p>
]]></description>
             <pubDate>Wed, 05 Mar 2014 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2014/01/16/artistic_style_vim.html</link>
            <guid>http://blog.shichao.io/blog/html/2014/01/16/artistic_style_vim.html</guid>
            <title><![CDATA[Use Artistic Style with vim]]></title>
            <description><![CDATA[<h1>Use Artistic Style with vim</h1>
<p>Artistic Style is a “Free, Fast and Small Automatic Formatter for C, C++, C++/CLI, C#, and Java Source Code”. It is basically a utility that reformats source code in a conventionally-defined indent and coding style.</p>
<p>First, install the program.</p>
<p>On Ubuntu/Debian:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo apt-get install astyle</span>
</pre></div>
</div>
<p>On OS X (with Homebrew):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ brew install astyle</span>
</pre></div>
</div>
<p>In order to use the command in a simple manner, you can set options in the options file <cite>~/.astylerc</cite>. I use the following options that uses Kernighan &amp; Ritchie (K&amp;R) style. For more supported styles and options, see <a class="reference external" href="http://astyle.sourceforge.net/astyle.html">http://astyle.sourceforge.net/astyle.html</a>.</p>
<div class="highlight-text"><div class="highlight"><pre>--style=kr
--indent=spaces=4
--indent-preprocessor
--pad-oper
--pad-header
--max-instatement-indent=40
--align-pointer=name
--align-reference=name
--keep-one-line-statements
--convert-tabs
--max-code-length=79
--pad-method-colon=none
</pre></div>
</div>
<p>Open vim, gVim or MacVim, and after editing some C/C++ files, use the following command to reformat the source code:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">:%!astyle</span>
</pre></div>
</div>
]]></description>
             <pubDate>Thu, 16 Jan 2014 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/11/17/sync_sleep_wakeup_ethernet_lan.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/11/17/sync_sleep_wakeup_ethernet_lan.html</guid>
            <title><![CDATA[Synchronize sleep and wakeup of machines on Ethernet LAN from Mac using SleepWatcher]]></title>
            <description><![CDATA[<h1>Synchronize sleep and wakeup of machines on Ethernet LAN from Mac using SleepWatcher</h1>
<p>The <a class="reference internal" href="http://blog.shichao.io/blog/html/2013/11/10/wake_suspend_machines_local_ethernet.html"><em>previous post</em></a> discusses remote suspend (sleep) and wakeup of machines on Ethernet LAN using pm-utils, GNU Screen and Wake-on-LAN (LAN). This post will discuss the synchronization of such behaviors of local and remote machines.</p>
<p>Suppose you are regularly working at home on a Mac (either MacBook or Mac mini or something else), and you have a spare PC running as an alternative to NAS or workstation on the same Ethernet LAN. If the spare PC is Linux, you may have set up netatalk on it to enable AFP file sharing or use it as a Time Capsule. However, since it is probably a netbook and may work only when your Mac is up, you don’t want it to run all days without doing anything. You can thus synchronize sleep and wakeup of your Mac with that PC.</p>
<p>You can download and install SleepWatcher to monitor sleep and wakeup on Mac and write some scripts upon these events.</p>
<ol class="arabic">
<li><p class="first">Download <a class="reference external" href="http://www.bernhard-baehr.de/sleepwatcher_2.2.tgz">SleepWatcher</a> (version 2.2 as of writing)</p>
</li>
<li><p class="first">Install it following the ReadMe.rtf instructions</p>
</li>
<li><p class="first">After the SleepWatcher LaunchAgent or LaunchDaemon is loaded, run the following commands to add sleep and wakeup scripts:</p>
<div class="highlight-python"><div class="highlight"><pre>$ echo "/path/to/your/sleep_script.sh" &gt; ~/.sleep
$ echo "sleep 5; /path/to/your/wakeup_script.sh" &gt; ~/.wakeup
$ chmod +x ~/.sleep ~/.wakeup
</pre></div>
</div>
</li>
</ol>
<p><span class="docutils literal"><span class="pre">/path/to/your/sleep_script.sh</span></span> and <span class="docutils literal"><span class="pre">/path/to/your/wakeup_script.sh</span></span> are scripts to suspend and wakeup the remote machine (reference the previous post). <span class="docutils literal"><span class="pre">sleep</span> <span class="pre">5</span></span> performs a delay to make sure the network is up to avoid “send : No route to host” error.
4. Test the setup by sleeping and waking up your Mac and check whether the remote machine does the same</p>
]]></description>
             <pubDate>Sun, 17 Nov 2013 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/11/10/wake_suspend_machines_local_ethernet.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/11/10/wake_suspend_machines_local_ethernet.html</guid>
            <title><![CDATA[Wake and suspend machines on local Ethernet LAN]]></title>
            <description><![CDATA[<h1>Wake and suspend machines on local Ethernet LAN</h1>
<p>Suppose you have a spare PC (say A) that supports Wake-on-LAN, you can first enable it by following <a class="reference external" href="http://www.cyberciti.biz/tips/linux-send-wake-on-lan-wol-magic-packets.html">this guide</a>. Then you can hack on some scripts on other local machines connected through Ethernet to remotely control A to make it suspend/hibernate and wake up as you want.</p>
<div class="section" id="wake">
<h2>Wake</h2>
<p>To wake up A is simple. Suppose A’s MAC address is 11:aa:22:bb:33:cc and the hostname is “machine-a”, and you want to wake it up from other machines (e.g. Machine B) on LAN, first install the wakeonlan utility (on Machine B).</p>
<p>On Debian/Ubuntu:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo apt-get install etherwake</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo apt-get install wakeonlan</span>
</pre></div>
</div>
<p>On Fedora/RHEL:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo apt-get install net-tools</span>
</pre></div>
</div>
<p>On OS X:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ brew install wakeonlan</span>
</pre></div>
</div>
<p>To send magic Wake-on-LAN packets to A:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ etherwake 11:aa:22:bb:33:cc</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ ether-wake 11:aa:22:bb:33:cc</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ wakeonlan 11:aa:22:bb:33:cc</span>
</pre></div>
</div>
</div>
<div class="section" id="suspend-hibernate">
<h2>Suspend/hibernate</h2>
<p class="readmorewrapper"><a class="readmore" href="http://blog.shichao.io/blog/html/2013/11/10/wake_suspend_machines_local_ethernet.html#more">Read more...</a></p> 
 
 
 
 
 
</div>
]]></description>
             <pubDate>Sun, 10 Nov 2013 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/11/05/apache_name_based_virtual_hosts.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/11/05/apache_name_based_virtual_hosts.html</guid>
            <title><![CDATA[Apache name-based virtual hosts and reverse DNS]]></title>
            <description><![CDATA[<h1>Apache name-based virtual hosts and reverse DNS</h1>
<p>On some operating systems such as Ubuntu, you can setup virtual hosts quite easily with the default Apache server (installed with APT). The global configuration file /etc/apache2/apache2.conf contains the following line as the last line by default:</p>
<div class="highlight-apache"><div class="highlight"><pre><span class="nb">Include</span> sites-enabled/
</pre></div>
</div>
<p>This means all virtual hosts configurations are loaded from the /etc/apache2/sites-enabled directory in alphabetical order. If you list this directory, you will find there is already a symbolic link 000-default that points to /etc/apache2/sites-available/default. This default virtual host configuration file does not contain a <span class="docutils literal"><span class="pre">ServerName</span></span> directive, and neither does the global configuration file (/etc/apache2/apache2.conf) by default. The default port.conf contains the following line:</p>
<div class="highlight-apache"><div class="highlight"><pre><span class="nb">NameVirtualHost</span> *:80
</pre></div>
</div>
<p>This means all the following name-virtual hosts will follow this <span class="docutils literal"><span class="pre">NameVirtualHost</span></span> directive, which receives requests on all interfaces on the server. <sup>[1]</sup></p>
<p>Basically, you can place your own virtual host configuration file in /etc/apache2/sites-available directory and use the a2ensite command to enable this configuration (by creating a symbolic link at /etc/apache2/sites-enabled that Apache will load). If you owns a domain example.com and a subdomain wiki.example.com that both points to the IP address of this server, you can create a virtual host with <span class="docutils literal"><span class="pre">ServerName</span> <span class="pre">wiki.example.com</span></span> (the argument to <span class="docutils literal"><span class="pre">&lt;VirtualHost&gt;</span></span> is *:80 in this case). If the configuration filename is wiki, you can use a2ensite wiki command to enable it.</p>
<p>Given these, let’s see how Apache handles requests for virtual hosts. When a request arrives, the server will find the best (most specific) matching <span class="docutils literal"><span class="pre">&lt;VirtualHost&gt;</span></span> argument based on the IP address and port used by the request. If there is more than one virtual host containing this best-match address and port combination, Apache will further compare the <span class="docutils literal"><span class="pre">ServerName</span></span> and <span class="docutils literal"><span class="pre">ServerAlias</span></span> directives to the server name present in the request. <sup>[2]</sup></p>
<p>If you try to visit wiki.example.com you actually request the IP of this server. The Apache server will handle this request by comparing active virtual host configurations. It first checks 000-default, but detects no <span class="docutils literal"><span class="pre">ServerName</span></span> directive (neither does the global configuration as mentioned before). As a result, it performs a reverse DNS lookup to find the <span class="docutils literal"><span class="pre">ServerName</span></span>. <sup>[3]</sup> If you have not setup a reverse DNS for this IP to wiki.example.com, the match will fail and Apache continues to match the next virtual host, wiki, which does have a <span class="docutils literal"><span class="pre">ServerName</span></span>, wiki.example.com, and this is a match. Apache will respond with this virtual host.</p>
<p>However, if you have recently setup a reverse DNS for IP of your server to wiki.example.com, a different result will come out. When you access wiki.example.com, Apache first checks 000-default, and performs a reverse DNS resolution only to find wiki.example.com as the result for <span class="docutils literal"><span class="pre">ServerName</span></span>, and this is a match. Apache will respond with 000-default instead of wiki and you will browse Web page for 000-default rather than wiki. To solve this problem, you can either set a global <span class="docutils literal"><span class="pre">ServerName</span></span> with example.com at /etc/apache2/apache2.conf or specify a <span class="docutils literal"><span class="pre">ServerName</span></span> for 000-default. In this way, the Apache will match the right <span class="docutils literal"><span class="pre">ServerName</span></span> with your request even if you setup a reverse DNS for one of the virtual hosts.</p>
<div class="section" id="reference">
<h2>Reference</h2>
<ol class="arabic simple">
<li><a class="reference external" href="http://httpd.apache.org/docs/2.2/mod/core.html#namevirtualhost">http://httpd.apache.org/docs/2.2/mod/core.html#namevirtualhost</a></li>
<li><a class="reference external" href="http://httpd.apache.org/docs/current/vhosts/name-based.html">http://httpd.apache.org/docs/current/vhosts/name-based.html</a></li>
<li><a class="reference external" href="http://httpd.apache.org/docs/current/dns-caveats.html">http://httpd.apache.org/docs/current/dns-caveats.html</a></li>
</ol>
</div>
]]></description>
             <pubDate>Tue, 05 Nov 2013 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/10/25/amazon_ec2_auto_scaling_example.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/10/25/amazon_ec2_auto_scaling_example.html</guid>
            <title><![CDATA[Amazon EC2 Auto Scaling example]]></title>
            <description><![CDATA[<h1>Amazon EC2 Auto Scaling example</h1>
<p>The following code creates an Auto Scaling group with scale-up and scale-down policies based on the monitoring the CPU utilization of either a specific EC2 instance or instances within the Auto Scaling group cluster.</p>
<p>If <span class="docutils literal"><span class="pre">alarm_dimensions</span></span> specifies <span class="docutils literal"><span class="pre">InstanceId</span></span>, the Auto Scaling group will scale up or down according to the CPU utilization of the specified running instance; if <span class="docutils literal"><span class="pre">alarm_dimensions</span></span> specifies <span class="docutils literal"><span class="pre">AutoScalingGroupName</span></span>, the Auto Scaling group will scale up or down according to the CPU utilization of instances within its existing cluster. For more metrics and dimensions in CloudWatch, see <a class="reference external" href="http://docs.aws.amazon.com/AmazonCloudWatch/latest/DeveloperGuide/ec2-metricscollected.html">Amazon Elastic Compute Cloud Dimensions and Metrics</a>.</p>
<p>Raw code can be <a class="reference external" href="https://raw.githubusercontent.com/moleculea/autoscale_sample/master/autoscale_sample.py">downloaded here</a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">boto.ec2</span>
<span class="kn">from</span> <span class="nn">boto.ec2.autoscale</span> <span class="kn">import</span> <span class="p">(</span><span class="n">AutoScalingGroup</span><span class="p">,</span>
                                <span class="n">LaunchConfiguration</span><span class="p">,</span> <span class="n">ScalingPolicy</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">boto.ec2.cloudwatch</span> <span class="kn">import</span> <span class="n">MetricAlarm</span>


<span class="c"># Create connections to Auto Scaling and CloudWatch</span>
<span class="n">as_conn</span> <span class="o">=</span> <span class="n">boto</span><span class="o">.</span><span class="n">ec2</span><span class="o">.</span><span class="n">autoscale</span><span class="o">.</span><span class="n">connect_to_region</span><span class="p">(</span><span class="s">"us-east-1"</span><span class="p">)</span>
<span class="n">cw_conn</span> <span class="o">=</span> <span class="n">boto</span><span class="o">.</span><span class="n">ec2</span><span class="o">.</span><span class="n">cloudwatch</span><span class="o">.</span><span class="n">connect_to_region</span><span class="p">(</span><span class="s">"us-east-1"</span><span class="p">)</span>

<span class="c"># Name for auto scaling group and launch configuration</span>
<span class="n">as_name</span> <span class="o">=</span> <span class="s">"VM1"</span>

<span class="c"># Create launch configuration</span>
<span class="n">lc</span> <span class="o">=</span> <span class="n">LaunchConfiguration</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span>
                         <span class="n">image_id</span><span class="o">=</span><span class="s">"ami-76f0061f"</span><span class="p">,</span>  <span class="c"># AMI ID of your instance</span>
                         <span class="n">key_name</span><span class="o">=</span><span class="s">"your_key_name"</span><span class="p">,</span>
                         <span class="n">security_groups</span><span class="o">=</span><span class="s">"your_group_name"</span><span class="p">,</span>
                         <span class="n">instance_type</span><span class="o">=</span><span class="s">"t1.micro"</span><span class="p">,</span>
                         <span class="n">instance_monitoring</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="n">as_conn</span><span class="o">.</span><span class="n">create_launch_configuration</span><span class="p">(</span><span class="n">lc</span><span class="p">)</span>

<span class="c"># Create Auto Scaling group</span>
<span class="n">ag</span> <span class="o">=</span> <span class="n">AutoScalingGroup</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span>
                      <span class="n">availability_zones</span><span class="o">=</span><span class="p">[</span><span class="s">"us-east-1b"</span><span class="p">],</span>
                      <span class="n">launch_config</span><span class="o">=</span><span class="n">lc</span><span class="p">,</span> <span class="n">min_size</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                      <span class="n">max_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                      <span class="n">connection</span><span class="o">=</span><span class="n">as_conn</span><span class="p">)</span>

<span class="n">as_conn</span><span class="o">.</span><span class="n">create_auto_scaling_group</span><span class="p">(</span><span class="n">ag</span><span class="p">)</span>

<span class="c"># Create scaling policies</span>
<span class="n">scale_up_policy</span> <span class="o">=</span> <span class="n">ScalingPolicy</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">'scale_up'</span><span class="p">,</span> <span class="n">adjustment_type</span><span class="o">=</span><span class="s">'ChangeInCapacity'</span><span class="p">,</span>
    <span class="n">as_name</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span> <span class="n">scaling_adjustment</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cooldown</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span>

<span class="n">scale_down_policy</span> <span class="o">=</span> <span class="n">ScalingPolicy</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">'scale_down'</span><span class="p">,</span> <span class="n">adjustment_type</span><span class="o">=</span><span class="s">'ChangeInCapacity'</span><span class="p">,</span>
    <span class="n">as_name</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span> <span class="n">scaling_adjustment</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cooldown</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span>

<span class="n">as_conn</span><span class="o">.</span><span class="n">create_scaling_policy</span><span class="p">(</span><span class="n">scale_up_policy</span><span class="p">)</span>
<span class="n">as_conn</span><span class="o">.</span><span class="n">create_scaling_policy</span><span class="p">(</span><span class="n">scale_down_policy</span><span class="p">)</span>

<span class="n">scale_up_policy</span> <span class="o">=</span> <span class="n">as_conn</span><span class="o">.</span><span class="n">get_all_policies</span><span class="p">(</span>
    <span class="n">as_group</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span> <span class="n">policy_names</span><span class="o">=</span><span class="p">[</span><span class="s">'scale_up'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">scale_down_policy</span> <span class="o">=</span> <span class="n">as_conn</span><span class="o">.</span><span class="n">get_all_policies</span><span class="p">(</span>
    <span class="n">as_group</span><span class="o">=</span><span class="n">as_name</span><span class="p">,</span> <span class="n">policy_names</span><span class="o">=</span><span class="p">[</span><span class="s">'scale_down'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

<span class="c"># Set dimensions for CloudWatch alarms</span>
<span class="c"># Monitor on a specific instance</span>
<span class="n">alarm_dimensions</span> <span class="o">=</span> <span class="p">{</span><span class="s">"InstanceId"</span><span class="p">:</span> <span class="s">"your_instance_id"</span><span class="p">}</span>

<span class="c"># Monitor instances within the Auto Scaling group cluster</span>
<span class="n">alarm_dimensions_as</span> <span class="o">=</span> <span class="p">{</span><span class="s">"AutoScalingGroupName"</span><span class="p">:</span> <span class="n">as_name</span><span class="p">}</span>

<span class="c"># Create metric alarms</span>
<span class="n">scale_up_alarm</span> <span class="o">=</span> <span class="n">MetricAlarm</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">'scale_up_on_cpu_'</span> <span class="o">+</span> <span class="n">as_name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s">'AWS/EC2'</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s">'CPUUtilization'</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s">'Average'</span><span class="p">,</span>
    <span class="n">comparison</span><span class="o">=</span><span class="s">'&gt;'</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s">"80"</span><span class="p">,</span>
    <span class="n">period</span><span class="o">=</span><span class="s">'60'</span><span class="p">,</span> <span class="n">evaluation_periods</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">alarm_actions</span><span class="o">=</span><span class="p">[</span><span class="n">scale_up_policy</span><span class="o">.</span><span class="n">policy_arn</span><span class="p">],</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="n">alarm_dimensions</span><span class="p">)</span>

<span class="n">scale_down_alarm</span> <span class="o">=</span> <span class="n">MetricAlarm</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">'scale_down_on_cpu_'</span> <span class="o">+</span> <span class="n">as_name</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="s">'AWS/EC2'</span><span class="p">,</span>
    <span class="n">metric</span><span class="o">=</span><span class="s">'CPUUtilization'</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="s">'Average'</span><span class="p">,</span>
    <span class="n">comparison</span><span class="o">=</span><span class="s">'&lt;'</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="s">"20"</span><span class="p">,</span>
    <span class="n">period</span><span class="o">=</span><span class="s">'60'</span><span class="p">,</span> <span class="n">evaluation_periods</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">alarm_actions</span><span class="o">=</span><span class="p">[</span><span class="n">scale_down_policy</span><span class="o">.</span><span class="n">policy_arn</span><span class="p">],</span>
    <span class="n">dimensions</span><span class="o">=</span><span class="n">alarm_dimensions</span><span class="p">)</span>

<span class="c"># Create alarms in CloudWatch</span>
<span class="n">cw_conn</span><span class="o">.</span><span class="n">create_alarm</span><span class="p">(</span><span class="n">scale_up_alarm</span><span class="p">)</span>
<span class="n">cw_conn</span><span class="o">.</span><span class="n">create_alarm</span><span class="p">(</span><span class="n">scale_down_alarm</span><span class="p">)</span>
</pre></div>
</div>
]]></description>
             <pubDate>Fri, 25 Oct 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/09/17/sync_backup_files_over_lan_ssh_osx.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/09/17/sync_backup_files_over_lan_ssh_osx.html</guid>
            <title><![CDATA[Sync and backup files from a host on the LAN over SSH on Mac OS X]]></title>
            <description><![CDATA[<h1>Sync and backup files from a host on the LAN over SSH on Mac OS X</h1>
<p>Suppose you have several computers on an LAN, where DHCP is enabled. On Machine B, you want to routinely back up files from Machine A, whose IP address may change. This can be done using SSH and a local DNS server. The following experiment is done on two Mac OS X 10.8 machines.</p>
<ol class="arabic">
<li><p class="first">Set up DNS server (optional):</p>
<p><em>named</em> and <em>rndc</em> utility are installed by default on Mac OS X 10.8. For references on setup, see <a class="reference external" href="http://www.macshadows.com/kb/index.php?title=How_To:_Enable_BIND_-_Mac_OS_X">this link</a>.</p>
<ol class="arabic">
<li><p class="first">Use <span class="docutils literal"><span class="pre">rndc-confgen</span></span> to generate configuration and secret key:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo bash -c "rndc-confgen -b 256 &gt; /etc/rndc.conf"</span>
<span class="go">$ sudo bash -c " head -n5 /etc/rndc.conf | tail -n4 &gt; /etc/rndc.key"</span>
</pre></div>
</div>
</li>
<li><p class="first">Edit /etc/named.conf and /etc/rndc.conf to ensure the port number are the same</p>
</li>
<li><p class="first">Start named server, run “rndc status” to check whether it is started:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ launchctl load -w /System/Library/LaunchDaemons/org.isc.named.plist</span>
<span class="go">$ launchctl start org.isc.named</span>
<span class="go">$ rndc status</span>
</pre></div>
</div>
</li>
<li><p class="first">Create a zone file for the target machine (Machine A in this case):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ cd ~/Documents/</span>
<span class="go">$ mkdir named</span>
<span class="go">$ cd named</span>
<span class="go">$ vi machine-a.zone</span>
</pre></div>
</div>
<p>Copy the following text in to machine-a.zone, the IP address 192.168.0.120 is irrelevant at this time:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$TTL 86400</span>
<span class="go">$ORIGIN machine-a.</span>

<span class="go">@       IN      SOA     @ root (</span>
<span class="go">                        2013091701      ; serial number YYMMDDNN</span>
<span class="go">                        28800           ; Refresh</span>
<span class="go">                        7200            ; Retry</span>
<span class="go">                        864000          ; Expire</span>
<span class="go">                        86400           ; Min TTL</span>
<span class="go">            )</span>
<span class="go">        IN      NS      @</span>
<span class="go">        IN      A       192.168.0.120   ; lan-sync</span>
</pre></div>
</div>
</li>
<li><p class="first">Create symbolic link at /var/named/machine-a.zone (/private/var/named/machine-a.zone):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ ln -s /Users/yourname/Documents/named/machine-a.zone /private/var/named/machine-a.zone</span>
</pre></div>
</div>
</li>
<li><p class="first">Edit /etc/named.conf, insert the following lines after the existing zone configurations:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">zone "machine-a" IN {</span>
<span class="go">        type master;</span>
<span class="go">        file "machine-a.zone";</span>
<span class="go">        allow-update { none; };</span>
<span class="go">};</span>
</pre></div>
</div>
</li>
<li><p class="first">Edit /etc/resolv.conf, replace existing nameserver with 127.0.0.1. This file should look like this:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">#</span>
<span class="go"># This file is automatically generated.</span>
<span class="go">#</span>
<span class="go">nameserver 127.0.0.1</span>
</pre></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Download the script and set the following variables in ssh_sync.sh:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ git clone https://github.com/moleculea/lan-sync-over-ssh</span>
<span class="go">$ cd lan-sync-over-ssh</span>
<span class="go">$ vi ssh_sync.sh</span>

<span class="go">user_home="/Users/yourname"</span>
<span class="go"># Remote hostname (LAN) and MAC address</span>
<span class="go">hostname="machine-a"</span>
<span class="go"># User name on the remote host</span>
<span class="go">username="yourname"</span>
<span class="go">mac_address="11:11:11:11:11:11"</span>
</pre></div>
</div>
</li>
</ol>
<p class="readmorewrapper"><a class="readmore" href="http://blog.shichao.io/blog/html/2013/09/17/sync_backup_files_over_lan_ssh_osx.html#more">Read more...</a></p> 
 
 
]]></description>
             <pubDate>Tue, 17 Sep 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/09/15/fetch_convert_online_flash_videos.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/09/15/fetch_convert_online_flash_videos.html</guid>
            <title><![CDATA[Fetch and convert online flash videos]]></title>
            <description><![CDATA[<h1>Fetch and convert online flash videos</h1>
<ol class="arabic">
<li><p class="first">Installation of prerequisite utilities:</p>
<ul class="simple">
<li>Perl module: WWW::Mechanize</li>
<li><a class="reference external" href="https://code.google.com/p/get-flash-videos/wiki/Installation">get-flash-videos</a></li>
<li><a class="reference external" href="http://www.ffmpeg.org/download.html">ffmpeg</a></li>
</ul>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo cpan install WWW::Mechanize</span>
<span class="go">$ git clone https://github.com/monsieurvideo/get-flash-videos.git /path/to/get-flash-videos</span>
<span class="go">$ ln -s /usr/local/bin/get_flash_videos /path/to/get-flash-videos/get_flash_videos</span>
</pre></div>
</div>
<p>For the installation of ffmpeg, see <a class="reference external" href="http://www.ffmpeg.org/download.html">http://www.ffmpeg.org/download.html</a>.</p>
</li>
<li><p class="first">Download flash-video-archiver scripts:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ git clone https://github.com/moleculea/flash-video-archiver.git flash-video-archiver</span>
</pre></div>
</div>
</li>
<li><p class="first">Create a file of video link list, e.g. videos.txt:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ cat /path/to/videos.txt</span>

<span class="go">http://example.com/video/4438</span>
<span class="go">http://example.com/video/4512</span>
<span class="go">http://example.org/video/hjkl</span>
</pre></div>
</div>
</li>
<li><p class="first">Fetch videos and convert them into MP4:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ cd flash-video-archiver</span>
<span class="go">$ ./fetch.sh /path/to/videos.txt /path/to/output/directory</span>
<span class="go">$ ./convert.sh /path/to/output/directory</span>
</pre></div>
</div>
</li>
</ol>
]]></description>
             <pubDate>Sun, 15 Sep 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/08/09/setup_selenium_python_environment_x_ubuntu.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/08/09/setup_selenium_python_environment_x_ubuntu.html</guid>
            <title><![CDATA[Set up Selenium Python environment with X virtual framebuffer on Ubuntu server]]></title>
            <description><![CDATA[<h1>Set up Selenium Python environment with X virtual framebuffer on Ubuntu server</h1>
<ol class="arabic">
<li><p class="first">Install relevant APT packages:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo apt-get install xorg</span>
<span class="go">$ sudo apt-get install xfvd</span>
<span class="go">$ sudo apt-get install firefox</span>
<span class="go">$ sudo apt-get install openjdk-7-jre</span>
<span class="go">$ sudo apt-get install python-pip</span>
</pre></div>
</div>
</li>
<li><p class="first">Download Selenium server and Python bindings:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo pip install selenium</span>
<span class="go">$ wget https://selenium.googlecode.com/files/selenium-server-standalone-2.34.0.jar</span>
</pre></div>
</div>
</li>
<li><p class="first">Start virtual framebuffer X server for server number 1 (for DISPLAY) in the background:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo Xvfb :1 &amp;</span>
<span class="go">$ sudo Xvfb :1 -screen 0 1280x1024x8</span>
</pre></div>
</div>
</li>
<li><p class="first">Start Selenium server in the background (without sudo):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ java -jar selenium-server-standalone-2.34.0.jar &amp;</span>
</pre></div>
</div>
</li>
<li><p class="first">Write sample Python code in sample.py:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>


<span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Firefox</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">"http://www.python.org"</span><span class="p">)</span>
<span class="k">assert</span> <span class="s">"Python"</span> <span class="ow">in</span> <span class="n">driver</span><span class="o">.</span><span class="n">title</span>
<span class="n">elem</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s">"q"</span><span class="p">)</span>
<span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s">"selenium"</span><span class="p">)</span>
<span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">RETURN</span><span class="p">)</span>
<span class="k">assert</span> <span class="s">"Google"</span> <span class="ow">in</span> <span class="n">driver</span><span class="o">.</span><span class="n">title</span>
<span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first">Run sample.py with environment variable DISPLAY=:1:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ DISPLAY=:1 python sample.py</span>
</pre></div>
</div>
</li>
</ol>
]]></description>
             <pubDate>Fri, 09 Aug 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/08/05/make_slideshow_gif_using_imagemagick.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/08/05/make_slideshow_gif_using_imagemagick.html</guid>
            <title><![CDATA[Make slideshow GIF from a batch of images using ImageMagick]]></title>
            <description><![CDATA[<h1>Make slideshow GIF from a batch of images using ImageMagick</h1>
<ol class="arabic">
<li><p class="first">Download and install ImageMagick Mac OS X Binary Release at ImageMagick official site.</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ tar xvfz ImageMagick-x86_64-apple-darwin12.4.0.tar.gz</span>
<span class="go">$ export MAGICK_HOME="/YOUR/PATH/TO/ImageMagick-6.8.6"</span>
<span class="go">$ export PATH="$MAGICK_HOME/bin:$PATH"</span>
<span class="go">$ export DYLD_LIBRARY_PATH="$MAGICK_HOME/lib/"</span>
</pre></div>
</div>
<p>See this for installation on Linux.</p>
</li>
<li><p class="first">Enter the directory where original images are stored (assuming all files are in .jpg format), use the following command:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ convert -delay 100 -loop 0 -resize 300x225 -quality 90 *.jpg image.gif</span>
</pre></div>
</div>
<p><span class="docutils literal"><span class="pre">-deplay</span></span> represents interval between slides, <span class="docutils literal"><span class="pre">-loop</span></span> indicates number of loops for slide show (0 for infinite loops); other options are intuitive. Note that *.jpg will expand to images ordered alphabetically by filename. Use the following command to re-order the images by last modified time:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ convert -delay 100 -loop 0 -resize 300x225 -quality 90 `ls -t *.jpg` image.gif</span>
</pre></div>
</div>
</li>
</ol>
]]></description>
             <pubDate>Mon, 05 Aug 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/07/20/configure_vsftpd_ftp_server_in_active_mode_on_centos.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/07/20/configure_vsftpd_ftp_server_in_active_mode_on_centos.html</guid>
            <title><![CDATA[Configure vsftpd FTP server in active mode on CentOS]]></title>
            <description><![CDATA[<h1>Configure vsftpd FTP server in active mode on CentOS</h1>
<ol class="arabic">
<li><p class="first">Install vsftpd, configure SELinux context and start the service:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># yum install vsftpd</span>
<span class="go"># chkconfig vsftpd on</span>
<span class="go"># chcon -R -t public_content_t /var/ftp</span>
<span class="go"># service vsftpd start</span>
</pre></div>
</div>
</li>
<li><p class="first">There are two ways to configure iptables to allow connections</p>
<p>One way is using system-config-firewall, which is simple:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># system-config-firewall-tui</span>
</pre></div>
</div>
<p>Choose FTP in the “Trusted Service” menu and save the configuration. <span class="docutils literal"><span class="pre">system-config-firewall</span></span> will add rule in the INPUT chain and load ip_conntrack_ftp kernel module, which can be verified using:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># lsmod | grep ftp</span>
<span class="go">nf_conntrack_ftp       10475  0</span>
<span class="go">nf_conntrack           65428  4 nf_conntrack_ftp,nf_conntrack_ipv6,nf_conntrack_ipv4,xt_state</span>
</pre></div>
</div>
<p>Another way is do it manually:</p>
<ol class="arabic">
<li><p class="first">Insert the following rule somewhere before the final “reject-with icmp-host-prohibited” rule, say number 4:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># iptables -L --line-numbers</span>
<span class="go"># iptables -I INPUT 4 -p tcp --dport 21 -m state --state NEW -j ACCEPT</span>
</pre></div>
</div>
</li>
<li><p class="first">Load ip_conntrack_ftp (alias of nf_conntrack_ftp):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># modprobe ip_conntrack_ftp</span>
</pre></div>
</div>
<p>Now the FTP directory should be accessible from remote machines.</p>
</li>
</ol>
</li>
</ol>
]]></description>
             <pubDate>Sat, 20 Jul 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/07/13/evaluation_criteria_of_computer_science_professional.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/07/13/evaluation_criteria_of_computer_science_professional.html</guid>
            <title><![CDATA[Evaluation criteria of computer science professionals]]></title>
            <description><![CDATA[<h1>Evaluation criteria of computer science professionals</h1>
<p>Personal point of view on how to evaluate the generic skills possessed by a computer software professional from a pragmatic perspective without considering specific subdisciplines or academic background in computer science.</p>
<ul class="simple">
<li>Programming Language<ul>
<li>Low-level: C/C++</li>
<li>Object-Oriented: Java/C++/PHP/Python/Ruby</li>
<li>Functional/Scripting: Lisp/Python/Perl/Haskell/Erlang</li>
<li>Web/Mobile: HTML/CSS/JavaScript</li>
</ul>
</li>
<li>System and Network<ul>
<li>System Administration (Unix)</li>
<li>OS/Kernel concept: Process, Memory, I/O</li>
<li>TCP/IP</li>
<li>Basic Scripting: bash/ksh/tcsh/zsh/Perl/Python</li>
</ul>
</li>
<li>Quantitative<ul>
<li>(Discrete) Math</li>
<li>Data Structures and Algorithms</li>
</ul>
</li>
<li>Software/Architecture/Engineering<ul>
<li>Design Pattern</li>
<li>Paradigm: Object-Oriented, Imperative</li>
<li>Purpose:</li>
<li>Low-level: kernel/driver/system/network</li>
<li>Architecture: HPC/HA/Cloud/Cluster/Distributed/Grid</li>
<li>Internet: Web/Mobile</li>
<li>Others: Architecture, Testing, SCM (SVN/Git)</li>
</ul>
</li>
<li>Database<ul>
<li>SQL/NoSQL/Cache</li>
<li>DBMS: MySQL/PostgreSQL/Oracle/MongoDB/…</li>
</ul>
</li>
<li>Conceptions<ul>
<li>Computer Architecture and Hardware</li>
</ul>
</li>
</ul>
]]></description>
             <pubDate>Sat, 13 Jul 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/07/11/get_inode_birth_time_os_x_and_bsd.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/07/11/get_inode_birth_time_os_x_and_bsd.html</guid>
            <title><![CDATA[Get the inode birth time (crtime or btime) of a file on Mac OS X and BSD descendants]]></title>
            <description><![CDATA[<h1>Get the inode birth time (crtime or btime) of a file on Mac OS X and BSD descendants</h1>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ stat -f "%SB %N" filename.txt</span>
<span class="go">Jul 11 22:27:33 2013 filename.txt</span>
</pre></div>
</div>
<p>According to the man page, <span class="docutils literal"><span class="pre">-f</span></span> is used to display information using the specified format. <span class="docutils literal"><span class="pre">S</span></span> is an optional output format specifier that represents a string output, and <span class="docutils literal"><span class="pre">B</span></span> is a required field specifier that represent the birth time of the inode. <span class="docutils literal"><span class="pre">N</span></span> represents the file name.</p>
]]></description>
             <pubDate>Thu, 11 Jul 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/07/02/convert_mysql_engine_from_myisam_to_innodb_django_models.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/07/02/convert_mysql_engine_from_myisam_to_innodb_django_models.html</guid>
            <title><![CDATA[Convert MySQL table's engine from MyISAM to InnoDB for Django models]]></title>
            <description><![CDATA[<h1>Convert MySQL table’s engine from MyISAM to InnoDB for Django models</h1>
<p>When I tried using django-activity-stream for my Django project, I cannot use syncdb, so I migrate it using South. When testing something like :</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">actstream</span> <span class="kn">import</span> <span class="n">action</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="s">'tested'</span><span class="p">)</span>
</pre></div>
</div>
<p>I got the following error:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">IntegrityError: (1452, 'Cannot add or update a child row: a</span>
<span class="go">foreign key constraint fails (`alexadb`.`actstream_action`,</span>
<span class="go">CONSTRAINT `actor_content_type_id_refs_id_357b994e` FOREIGN</span>
<span class="go">KEY (`actor_content_type_id`) REFERENCES `django_content_type`</span>
<span class="go">(`id`))')</span>
</pre></div>
</div>
<p>It seems the foreign key constraint fail is related to table <span class="docutils literal"><span class="pre">django_content_type</span></span>. Therefore, I ran the following MySQL command to check the engine of this table:</p>
<div class="highlight-mysql"><div class="highlight"><pre><span class="k">SHOW</span> <span class="k">TABLE</span> <span class="n">STATUS</span> <span class="k">WHERE</span> <span class="n">name</span><span class="o">=</span><span class="s1">'django_content_type'</span><span class="p">;</span>
</pre></div>
</div>
<p>The result for column ‘Engine’ is MyISAM, which is why it does not support foreign key constraint. One solution is to convert it to InnoDB. However, the following MySQL command seems to take a ‘very’ long time (even if it is not a very large table) that I cannot observe for about 5 minutes.</p>
<div class="highlight-mysql"><div class="highlight"><pre><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">django_content_type</span> <span class="kp">ENGINE</span> <span class="o">=</span> <span class="n">InnoDB</span><span class="p">;</span>
</pre></div>
</div>
<p>To make the conversion quicker, I have to use another solution, which is recreating the <span class="docutils literal"><span class="pre">django_content_type</span></span> table with its engine being InnoDB.</p>
<p>This requires the following steps:</p>
<ol class="arabic">
<li><p class="first">In the project directory, dump the app model data associated with table <span class="docutils literal"><span class="pre">django_content_type</span></span>. This app and model name is <span class="docutils literal"><span class="pre">contenttypes.ContentType</span></span> (<span class="docutils literal"><span class="pre">django.contrib.contenttypes.models.ContentType</span></span>).</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ python manage.py dumpdata contenttypes.ContentType &gt; contenttypes.json</span>
</pre></div>
</div>
</li>
<li><p class="first">Drop table <span class="docutils literal"><span class="pre">django_content_type</span></span> in MySQL:</p>
<div class="highlight-mysql"><div class="highlight"><pre><span class="k">DROP</span> <span class="k">TABLE</span> <span class="n">django_content_type</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p class="first">Get SQL statement of model <span class="docutils literal"><span class="pre">contenttypes.ContentType</span></span>:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ python manage.py sqlall contenttypes</span>
<span class="go">BEGIN;</span>
<span class="go">CREATE TABLE `django_content_type` (</span>
<span class="go">    `id` integer AUTO_INCREMENT NOT NULL PRIMARY KEY,</span>
<span class="go">    `name` varchar(100) NOT NULL,</span>
<span class="go">    `app_label` varchar(100) NOT NULL,</span>
<span class="go">    `model` varchar(100) NOT NULL,</span>
<span class="go">    UNIQUE (`app_label`, `model`)</span>
<span class="go">)</span>
<span class="go">;</span>

<span class="go">COMMIT;</span>
</pre></div>
</div>
<p>Add <span class="docutils literal"><span class="pre">Engine=InnoDB</span></span> to the statement, and run this in MySQL:</p>
<div class="highlight-mysql"><div class="highlight"><pre><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="ss">`django_content_type`</span> <span class="p">(</span>
    <span class="ss">`id`</span> <span class="kt">integer</span> <span class="kp">AUTO_INCREMENT</span> <span class="k">NOT</span> <span class="no">NULL</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
    <span class="ss">`name`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="ss">`app_label`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="ss">`model`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="k">UNIQUE</span> <span class="p">(</span><span class="ss">`app_label`</span><span class="p">,</span> <span class="ss">`model`</span><span class="p">)</span>
<span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span>
<span class="p">;</span>
</pre></div>
</div>
</li>
<li><p class="first">Load dumped data into database:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ python manage.py loaddata contenttypes.json</span>
</pre></div>
</div>
</li>
<li><p class="first">Finally, the testing of django-activity-stream should work without errors:</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">myapp.models</span> <span class="kn">import</span> <span class="n">Foo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">Foo</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">actstream</span> <span class="kn">import</span> <span class="n">action</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">verb</span><span class="o">=</span><span class="s">'tested'</span><span class="p">)</span>
<span class="go">[(&lt;function action_handler at 0x1102ff410&gt;, None)]</span>
</pre></div>
</div>
</li>
</ol>
]]></description>
             <pubDate>Tue, 02 Jul 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/06/30/add_static_route_on_mac_osx_and_bsd.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/06/30/add_static_route_on_mac_osx_and_bsd.html</guid>
            <title><![CDATA[Add static routes on Mac OS X and BSD descendants]]></title>
            <description><![CDATA[<h1>Add static routes on Mac OS X and BSD descendants</h1>
<p>Add a static route:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># route -n add -net 192.168.122.0/24  192.168.0.117</span>
</pre></div>
</div>
<p>This is equivalent to the Linux command:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># route add -net 192.168.122.0 netmask 255.255.255.0 gw 192.168.0.117</span>
</pre></div>
</div>
<p>List routing tables:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># netstat -r</span>
</pre></div>
</div>
]]></description>
             <pubDate>Sun, 30 Jun 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/03/29/su_sudo_and_environment.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/03/29/su_sudo_and_environment.html</guid>
            <title><![CDATA[su, sudo, and environment]]></title>
            <description><![CDATA[<h1>su, sudo, and environment</h1>
<ol class="arabic">
<li><p class="first"><strong>sudo -i</strong></p>
<p><span class="docutils literal"><span class="pre">sudo</span> <span class="pre">-i</span> <span class="pre">[command]</span></span>
If command is omitted, it spawns a login shell of the target user (usually root) modifying the environment. Otherwise, the command is passed to the shell for execution.</p>
</li>
<li><p class="first"><strong>sudo -s</strong></p>
<p><span class="docutils literal"><span class="pre">sudo</span> <span class="pre">-s</span> <span class="pre">[command]</span></span></p>
<p>If command is omitted, it spawns spawns a login shell of the target user (usually root) without modifying the environment. Otherwise, the command is passed to the shell for execution.</p>
<p>This command is useful if you want to keep the environment variables (such as <span class="docutils literal"><span class="pre">HISTFILE</span></span> for history) when executing sudo. Use <span class="docutils literal"><span class="pre">env</span></span> or <span class="docutils literal"><span class="pre">declare</span></span> to see the environment.</p>
<p>Note that if <span class="docutils literal"><span class="pre">always_set_home</span></span> is enabled in <span class="docutils literal"><span class="pre">/etc/sudoers</span></span> (with a line <span class="docutils literal"><span class="pre">Defaults</span> <span class="pre">always_set_home</span></span>), after you execute <span class="docutils literal"><span class="pre">sudo</span> <span class="pre">-s</span></span>, the <span class="docutils literal"><span class="pre">HOME</span></span> will be changed to the homedir of the target user, as if you execute <span class="docutils literal"><span class="pre">sudo</span> <span class="pre">-sH</span></span>.</p>
</li>
<li><p class="first"><strong>sudo bash -c</strong></p>
<p><span class="docutils literal"><span class="pre">sudo</span> <span class="pre">bash</span> <span class="pre">-c</span> <span class="pre">'command</span> <span class="pre">string'</span></span></p>
<p>As a regular user, the following command will fail:</p>
<p><span class="docutils literal"><span class="pre">sudo</span> <span class="pre">ls</span> <span class="pre">&gt;</span> <span class="pre">/root/ls.txt</span></span></p>
<p>Because although the shell that sudo spawns executes ls with root privileges, the non-privileged shell that the user is running redirects the output.</p>
<p>As a solution, use the following command:</p>
<p><span class="docutils literal"><span class="pre">sudo</span> <span class="pre">bash</span> <span class="pre">-c</span> <span class="pre">'ls</span> <span class="pre">&gt;</span> <span class="pre">/root/ls.txt'</span></span></p>
<p><span class="docutils literal"><span class="pre">bash</span> <span class="pre">-c</span></span> spawns a shell that executes the string following the option and then terminates. The sudo utility runs the spawned shell with root privileges (without modifying environment).</p>
</li>
<li><p class="first"><strong>su -c</strong></p>
<p><span class="docutils literal"><span class="pre">su</span> <span class="pre">-c</span> <span class="pre">'command</span> <span class="pre">string'</span></span></p>
<p>Similar to the previous one, <span class="docutils literal"><span class="pre">su</span> <span class="pre">-c</span></span> runs a command with root privileges and returna to original shell after execution.</p>
<p>For example,</p>
<p><span class="docutils literal"><span class="pre">su</span> <span class="pre">-c</span> <span class="pre">'ls</span> <span class="pre">&gt;</span> <span class="pre">/root/ls.txt'</span></span></p>
<p>In conclusion, 1, 2 and 3 uses sudo utility to execute single commands and have the advantage of not requiring root password.</p>
</li>
</ol>
<p>Reference:</p>
<p>Mark G. Sobell. A Practical Guide to Ubuntu Linux, Third Edition. 2010</p>
]]></description>
             <pubDate>Fri, 29 Mar 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/03/19/create_a_personal_website_with_sphinx.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/03/19/create_a_personal_website_with_sphinx.html</guid>
            <title><![CDATA[Create a personal website with Sphinx]]></title>
            <description><![CDATA[<h1>Create a personal website with Sphinx</h1>
<p>Sphinx is a documentation generator which converts reStructuredText files into HTML websites and other formats e.g. LaTeX (PDF) and man pages. It’s also a good idea to create simple static website with Sphinx, for example, a personal profile site.</p>
<p>However, as the default purpose of Sphinx is to create documentation, it requires some customization regarding template structure and style. The following steps help create a simple profile site based on the built-in themes of Sphinx.</p>
<ol class="arabic">
<li><p class="first">Download <a class="reference external" href="http://sphinx-doc.org/index.html">Sphinx</a>, create a base directory and quick-start Sphinx. It’ll be helpful to answer “yes” to “Create Makefile?” during sphinx-quickstart:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ easy_install -U sphinx</span>
<span class="go">$ mkdir base_dir</span>
<span class="go">$ cd base_dir</span>
<span class="go">$ sphinx-quickstart</span>
</pre></div>
</div>
</li>
<li><p class="first">Change site title.</p>
<p>Edit <span class="docutils literal"><span class="pre">conf.py</span></span> in the source directory and make the following modifications:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">html_title</span> <span class="o">=</span> <span class="s">"YOUR SITE TITLE"</span>
<span class="c">#version = '0.0.1'</span>
<span class="c">#release = '0.0.1'</span>
</pre></div>
</div>
<p>Comment version and release to prevent this version number from being displayed in titles.</p>
</li>
<li><p class="first">Customize the content structure based on “basic” theme or its derivatives (“default” and “nature”). We take “nature” as an example here.</p>
<p>First, edit <span class="docutils literal"><span class="pre">conf.py</span></span> and make the following modifications:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">html_theme</span> <span class="o">=</span> <span class="s">'nature'</span>
<span class="n">html_sidebars</span> <span class="o">=</span> <span class="p">{</span><span class="s">'**'</span><span class="p">:[</span><span class="s">'localtoc.html'</span><span class="p">,</span><span class="s">'searchbox.html'</span><span class="p">]}</span>
</pre></div>
</div>
<p><span class="docutils literal"><span class="pre">html_sidebars</span></span> determines the built-in templates to be displayed in the sidebar. For other built-in templates and detailed information, see <span class="docutils literal"><span class="pre">html_sidebars</span></span>.</p>
<p>Second, make sure the settings of the following variables:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">templates_path</span> <span class="o">=</span> <span class="p">[</span><span class="s">'_templates'</span><span class="p">]</span>
<span class="n">html_static_path</span> <span class="o">=</span> <span class="p">[</span><span class="s">'_static'</span><span class="p">]</span>
</pre></div>
</div>
<p><span class="docutils literal"><span class="pre">_templates</span></span> directory stores template files; _static directory stores static files such as CSS and images. These two directories reside in source directory.</p>
<p>Third, create your own template <span class="docutils literal"><span class="pre">layout.html</span></span> inheriting from the default theme:</p>
<div class="highlight-python"><div class="highlight"><pre>$ cd source/_template
$ vi layout.html
</pre></div>
</div>
<p>Edit layout.html:</p>
<div class="highlight-jinja"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">"!layout.html"</span> <span class="cp">%}</span><span class="x"/>
<span class="cp">{%</span>- <span class="k">set</span> <span class="nv">rellinks</span> <span class="o">=</span> <span class="o">[]</span> <span class="cp">%}</span><span class="x"/>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">rootrellink</span> <span class="cp">%}</span><span class="x">&lt;/pre&gt;</span>
<span class="x">&lt;ul&gt;</span>
<span class="x">    &lt;li&gt;&lt;a href="index.html"&gt;Home&lt;/a&gt; |&lt;/li&gt;</span>
<span class="x">    &lt;li&gt;&lt;a href="resume.html"&gt;Resume&lt;/a&gt; |&lt;/li&gt;</span>
<span class="x">    &lt;li&gt;&lt;a href="projects.html"&gt;Projects&lt;/a&gt; |&lt;/li&gt;</span>
<span class="x">    &lt;li&gt;&lt;a href="interest.html"&gt;Interest&lt;/a&gt; |&lt;/li&gt;</span>
<span class="x">    &lt;li&gt;&lt;a href="contact.html"&gt;Contact&lt;/a&gt;&lt;/li&gt;</span>
<span class="x">    &lt;li&gt;</span><span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x"/>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">relbar2</span> <span class="cp">%}</span><span class="x"/>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x"/>
<span class="x">The template above creates a header navigation bar of different entries of your sites.</span>

<span class="cp">{%</span>- <span class="k">set</span> <span class="nv">rellinks</span> <span class="o">=</span> <span class="o">[]</span> <span class="cp">%}</span><span class="x"> disables related links (i.e. prev, next and index).</span>
</pre></div>
</div>
</li>
<li><p class="first">Create reStructuredText (.rst) source files for your entries (<span class="docutils literal"><span class="pre">index.html</span></span>, <span class="docutils literal"><span class="pre">resume.html</span></span>, <span class="docutils literal"><span class="pre">projects.html</span></span>, <span class="docutils literal"><span class="pre">interest.html</span></span>, <span class="docutils literal"><span class="pre">contact.html</span></span>):</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ cd source</span>
<span class="go">$ vi index.rst</span>
</pre></div>
</div>
<p>Use the following format, which also applies to other .rst files, such as <span class="docutils literal"><span class="pre">resume.rst</span></span>, <span class="docutils literal"><span class="pre">projects.rst</span></span>, <span class="docutils literal"><span class="pre">interest.html</span></span> and <span class="docutils literal"><span class="pre">contact.html</span></span>.</p>
<div class="highlight-rst"><div class="highlight"><pre><span class="gh">Welcome</span>
<span class="gh">*******</span>
Welcome to my site!

<span class="gh">About me</span>
<span class="gh">========</span>
I am Blah Blah ...

<span class="gh">More info</span>
<span class="gh">=========</span>
Blah...

<span class="p">..</span> <span class="ow">toctree</span><span class="p">::</span>
   <span class="nc">:maxdepth:</span> <span class="nf">2</span>
</pre></div>
</div>
</li>
</ol>
<p class="readmorewrapper"><a class="readmore" href="http://blog.shichao.io/blog/html/2013/03/19/create_a_personal_website_with_sphinx.html#more">Read more...</a></p> 
]]></description>
             <pubDate>Tue, 19 Mar 2013 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/02/07/send_mails_with_mutt_on_linux.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/02/07/send_mails_with_mutt_on_linux.html</guid>
            <title><![CDATA[Send mails with mutt on Linux]]></title>
            <description><![CDATA[<h1>Send mails with mutt on Linux</h1>
<p>Given that the sendmail MTA is in use on Linux.</p>
<p>Install mutt:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># yum install mutt</span>
<span class="go"># vi ~/.muttrc</span>
</pre></div>
</div>
<p>Append the following into <span class="docutils literal"><span class="pre">.muttrc</span></span>:</p>
<div class="highlight-text"><div class="highlight"><pre>set sendmail="/usr/sbin/sendmail"
set use_from=yes
set realname="webmaster"
set from=no-replay@example.com
set envelope_from=yes
</pre></div>
</div>
<p>Send email:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go"># echo "CONTENT" | mutt -s "SUBJECT" -a /path/to/attachment.zip receiver@example.com</span>
</pre></div>
</div>
]]></description>
             <pubDate>Thu, 07 Feb 2013 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/01/25/loop_statements_in_perl.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/01/25/loop_statements_in_perl.html</guid>
            <title><![CDATA[Loop statements in Perl]]></title>
            <description><![CDATA[<h1>Loop statements in Perl</h1>
<p>Loop statement in Perl seems to conform to the TMTOWTDI or “There’s more than one way to do it” philosophy.</p>
<p>The contents below is copied from Chinese Wikipedia article.</p>
<p>Define an array group and we have the following loop statements which perform the same thing:</p>
<div class="highlight-perl"><div class="highlight"><pre><span class="nv">@group</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">..</span> <span class="mi">10</span><span class="p">;</span>
<span class="k">for</span> <span class="p">(</span><span class="nv">@group</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s">"$_\n"</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">print</span> <span class="s">"$_\n"</span> <span class="k">for</span> <span class="nv">@group</span><span class="p">;</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">@group</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s">"$_\n"</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>for, which is borrowed from C:</p>
<div class="highlight-perl"><div class="highlight"><pre><span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s">"$group[$i]\n"</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>while:</p>
<div class="highlight-perl"><div class="highlight"><pre><span class="nv">$i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="k">while</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s">"$group[$i]\n"</span><span class="p">;</span>
    <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>do…while:</p>
<div class="highlight-perl"><div class="highlight"><pre><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">do</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s">"$group[$i]\n"</span><span class="p">;</span>
    <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">);</span>
</pre></div>
</div>
<p>until:</p>
<div class="highlight-perl"><div class="highlight"><pre><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">until</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s">"$group[$i]\n"</span><span class="p">;</span>
    <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>do…until, borrowed from PASCAL:</p>
<div class="highlight-perl"><div class="highlight"><pre><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">do</span> <span class="p">{</span>
    <span class="k">print</span> <span class="s">"$group[$i]\n"</span><span class="p">;</span>
    <span class="nv">$i</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span> <span class="k">until</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">==</span> <span class="mi">10</span><span class="p">);</span>
</pre></div>
</div>
<p>map, some kind of functional:</p>
<div class="highlight-perl"><div class="highlight"><pre><span class="nb">map</span> <span class="p">{</span> <span class="k">print</span> <span class="s">"$_\n"</span> <span class="p">}</span> <span class="nv">@group</span><span class="p">;</span>
</pre></div>
</div>
]]></description>
             <pubDate>Fri, 25 Jan 2013 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/01/24/gson_simple_example_of_json_serialization.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/01/24/gson_simple_example_of_json_serialization.html</guid>
            <title><![CDATA[GSON simple example of JSON deserialization and use of parser]]></title>
            <description><![CDATA[<h1>GSON simple example of JSON deserialization and use of parser</h1>
<p>It seems that JSON-lib is a bit old and requires many dependencies, so I try to have a quick look at Google GSON, which has become the most popular tools for JSON in Java.</p>
<div class="highlight-json"><div class="highlight"><pre><span class="p">{</span>
    <span class="nt">"id"</span><span class="p">:</span> <span class="s2">"10001"</span><span class="p">,</span>
    <span class="nt">"time"</span><span class="p">:</span> <span class="s2">"20.1"</span><span class="p">,</span>
    <span class="nt">"result"</span><span class="p">:</span> <span class="p">[{</span>
        <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"John"</span><span class="p">,</span>
        <span class="nt">"age"</span><span class="p">:</span> <span class="s2">"22"</span>
        <span class="p">},{</span>
        <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"Jim"</span><span class="p">,</span>
        <span class="nt">"age"</span><span class="p">:</span> <span class="s2">"23"</span>
        <span class="p">},{</span>
        <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"Rachel"</span><span class="p">,</span>
        <span class="nt">"age"</span><span class="p">:</span> <span class="s2">"21"</span>
        <span class="p">}]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>GsonTest.java</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">gson</span><span class="o">.</span><span class="na">test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.gson.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.io.FileUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GsonTest</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Deserialize JSON to object</span>
        <span class="n">String</span> <span class="n">txt</span> <span class="o">=</span> <span class="s">"{'name': 'James', 'age': '25'}"</span><span class="o">;</span>
        <span class="n">Gson</span> <span class="n">gson</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Gson</span><span class="o">();</span>
        <span class="n">Person</span> <span class="n">person</span> <span class="o">=</span> <span class="n">gson</span><span class="o">.</span><span class="na">fromJson</span><span class="o">(</span><span class="n">txt</span><span class="o">,</span> <span class="n">Person</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">person</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="cm">/*</span>
<span class="cm">         * name: James</span>
<span class="cm">         * age: 25</span>
<span class="cm">         *</span>
<span class="cm">         * */</span>

        <span class="n">String</span> <span class="n">r</span> <span class="o">=</span> <span class="n">readToString</span><span class="o">(</span><span class="s">"/path/to/json.txt"</span><span class="o">);</span>

        <span class="c1">// Parse JSON directly (into JsonElement)</span>
        <span class="n">JsonParser</span> <span class="n">parser</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JsonParser</span><span class="o">();</span>
        <span class="n">JsonObject</span> <span class="n">obj</span> <span class="o">=</span> <span class="o">(</span><span class="n">JsonObject</span><span class="o">)</span><span class="n">parser</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">r</span><span class="o">);</span>
        <span class="n">JsonElement</span> <span class="n">id</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"id"</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">id</span><span class="o">);</span> <span class="c1">// Prints "10001"</span>

        <span class="n">JsonArray</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"result"</span><span class="o">).</span><span class="na">getAsJsonArray</span><span class="o">();</span>
        <span class="n">JsonElement</span> <span class="n">p</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">p</span><span class="o">);</span> <span class="c1">// Prints {"name": "John","age": "22"}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">readToString</span><span class="o">(</span><span class="n">String</span> <span class="n">path</span><span class="o">){</span>
        <span class="n">File</span> <span class="n">f</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">path</span><span class="o">);</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="n">String</span> <span class="n">r</span> <span class="o">=</span> <span class="n">FileUtils</span><span class="o">.</span><span class="na">readFileToString</span><span class="o">(</span><span class="n">f</span><span class="o">,</span> <span class="s">"UTF-8"</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">r</span><span class="o">;</span>
        <span class="o">}</span>
        <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">){</span>
             <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
             <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="kd">class</span> <span class="nc">Person</span><span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">age</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Person</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">String</span> <span class="n">age</span><span class="o">){</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">(){</span>
         <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringBuilder</span><span class="o">();</span>
         <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"name: "</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">"\n"</span><span class="o">);</span>
         <span class="n">sb</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"age: "</span> <span class="o">+</span> <span class="n">age</span> <span class="o">+</span> <span class="s">"\n"</span><span class="o">);</span>
         <span class="k">return</span> <span class="n">sb</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
]]></description>
             <pubDate>Thu, 24 Jan 2013 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/01/08/wep_craking_experiment_on_ubuntu_12_10.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/01/08/wep_craking_experiment_on_ubuntu_12_10.html</guid>
            <title><![CDATA[WEP cracking experiment on Ubuntu 12.10]]></title>
            <description><![CDATA[<h1>WEP cracking experiment on Ubuntu 12.10</h1>
<p>This experiment follows the online basic tutorials at <a class="reference external" href="http://www.aircrack-ng.org">http://www.aircrack-ng.org/</a> and is done in terms of learning.</p>
<ol class="arabic">
<li><p class="first">Download and install <a class="reference external" href="http://www.aircrack-ng.org">Aircrack-ng suite</a>:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo apt-get install aircrack-ng</span>
</pre></div>
</div>
</li>
<li><p class="first">Start the wireless card in monitor mode, discover Access Points (AP) and determine a proper target AP:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ iwconfig</span>
<span class="go">wlan0     IEEE 802.11bgn  ESSID:off/any</span>
<span class="go">          Mode:Managed  Access Point: Not-Associated   Tx-Power=16 dBm</span>
<span class="go">          Retry  long limit:7   RTS thr:off   Fragment thr:off</span>
<span class="go">          Power Management:off</span>

<span class="go">lo        no wireless extensions.</span>

<span class="go">eth0      no wireless extensions.</span>

<span class="go">$ sudo airmon-ng start wlan0</span>
<span class="go">Interface   Chipset     Driver</span>

<span class="go">wlan0       Atheros     ath9k - [phy0]</span>
<span class="go">                (monitor mode enabled on mon0)</span>

<span class="go">$ sudo airodump-ng mon0</span>
</pre></div>
</div>
<p><a class="reference internal" href="http://blog.shichao.io/blog/html/_images/02_1-e1357703106181.png"><img alt="02_1" src="http://blog.shichao.io/blog/html/_images/02_1-e1357703106181.png" style="width: 450px;"/></a></p>
<p>The screenshot above shows the APs on different channels. Choose a WEP target.</p>
</li>
<li><p class="first">Start the wireless interface with the same channel to the target AP.</p>
<p>Assume our target AP has ESSID “TARGET-NET” and BSSID (MAC address) “C0:3F:0E:D3:XX:XX” on channel 11.</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo airmon-ng stop wlan0</span>
<span class="go">$ sudo airmon-ng stop mon0</span>
<span class="go">$ sudo airmon-ng start wlan0 11</span>
<span class="go">Interface   Chipset     Driver</span>

<span class="go">wlan0       Atheros     ath9k - [phy0]</span>
<span class="go">                (monitor mode enabled on mon0)</span>
</pre></div>
</div>
</li>
<li><p class="first">Test packet injection on the target AP.</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo aireplay-ng -9 -e TARGET-NET -a C0:3F:0E:D3:XX:XX mon0</span>
<span class="go">20:38:56  Waiting for beacon frame (BSSID: C0:3F:0E:D3:XX:XX) on channel 11</span>
<span class="go">20:38:56  Trying broadcast probe requests...</span>
<span class="go">20:38:56  Injection is working!</span>
<span class="go">20:38:58  Found 1 AP</span>

<span class="go">20:38:58  Trying directed probe requests...</span>
<span class="go">20:38:58  C0:3F:0E:D3:XX:XX - channel: 11 - 'TARGET-NET'</span>
<span class="go">20:39:00  Ping (min/avg/max): 1.664ms/6.917ms/39.315ms Power: -78.96</span>
<span class="go">20:39:00  23/30:  76%</span>
</pre></div>
</div>
</li>
</ol>
<p class="readmorewrapper"><a class="readmore" href="http://blog.shichao.io/blog/html/2013/01/08/wep_craking_experiment_on_ubuntu_12_10.html#more">Read more...</a></p> 
]]></description>
             <pubDate>Tue, 08 Jan 2013 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2012/12/25/adjust_brightness_in_kubuntu_12_10_on_acer_aspire_one.html</link>
            <guid>http://blog.shichao.io/blog/html/2012/12/25/adjust_brightness_in_kubuntu_12_10_on_acer_aspire_one.html</guid>
            <title><![CDATA[Adjust brightness in Kubuntu 12.10 on Acer Aspire One]]></title>
            <description><![CDATA[<h1>Adjust brightness in Kubuntu 12.10 on Acer Aspire One</h1>
<p>Fn-Left and Fn-Right do not work to change brightness.</p>
<p>Find the answer here: <a class="reference external" href="http://askubuntu.com/questions/112050/acer-aspire-one-d270-can-not-set-brightness">http://askubuntu.com/questions/112050/acer-aspire-one-d270-can-not-set-brightness</a></p>
<p>Modify grub config file:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo vi /etc/default/grub</span>
</pre></div>
</div>
<p>Change the line:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">GRUB_CMDLINE_LINUX=""</span>
</pre></div>
</div>
<p>into:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">GRUB_CMDLINE_LINUX="acpi_osi=Linux"</span>
</pre></div>
</div>
<p>Then, update grub:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo update-grub</span>
</pre></div>
</div>
<p>Reboot</p>
]]></description>
             <pubDate>Tue, 25 Dec 2012 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2012/12/23/dual_boot_ubuntu_and_fedora_on_laptop.html</link>
            <guid>http://blog.shichao.io/blog/html/2012/12/23/dual_boot_ubuntu_and_fedora_on_laptop.html</guid>
            <title><![CDATA[Dual boot Ubuntu and Fedora on laptop]]></title>
            <description><![CDATA[<h1>Dual boot Ubuntu and Fedora on laptop</h1>
<p>Install Ubuntu 12.10 first and then Fedora 17 on the laptop using USB media.</p>
<ol class="arabic">
<li><p class="first">Install Ubuntu 12.10 with some free space unallocated</p>
</li>
<li><p class="first">Install Fedora 17 in a new partition in the free space</p>
</li>
<li><p class="first">Restart and boot Ubuntu, install lvm for Fedora and update grub:</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ sudo apt-get install lvm2</span>
<span class="go">$ sudo mount /dev/sdaN /mnt</span>
<span class="go">$ sudo update-grub</span>
</pre></div>
</div>
<p>(/dev/sdaN is the partition for Fedora for the only mount point /)</p>
</li>
<li><p class="first">Reboot</p>
</li>
</ol>
]]></description>
             <pubDate>Sun, 23 Dec 2012 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2013/01/05/fix_eclipse_icon_in_unity_dash_on_ubuntu_12_10.html</link>
            <guid>http://blog.shichao.io/blog/html/2013/01/05/fix_eclipse_icon_in_unity_dash_on_ubuntu_12_10.html</guid>
            <title><![CDATA[Fix Eclipse icon (not displayed, too big) in Unity Dash on Ubuntu 12.10]]></title>
            <description><![CDATA[<h1>Fix Eclipse icon (not displayed, too big) in Unity Dash on Ubuntu 12.10</h1>
<p>It seems that the regular methods of merely creating eclipse.desktop (specifying Icon path as icon.xpm in the decompressed folder of Eclipse) which applied to Ubuntu 12.04 does not work on 12.10. The problem is that the icon is too big for Dash to render.</p>
<p>The huge icon can be obviously seen in “Dash Home” search results and <span class="docutils literal"><span class="pre">/usr/share/applications/</span></span> folder.</p>
<p>Someone has already reported this as a bug at <a class="reference external" href="https://bugs.launchpad.net/ubuntu/+source/dash/+bug/1068702">https://bugs.launchpad.net/ubuntu/+source/dash/+bug/1068702</a> .</p>
<p>Found the simplest solution here.</p>
<p>Copy <span class="docutils literal"><span class="pre">icon.xpm</span></span> (from eclipse folder) into <span class="docutils literal"><span class="pre">~/.local/share/icons/eclipse4.xpm</span></span></p>
<p>In your <span class="docutils literal"><span class="pre">eclipse.desktop</span></span> file (which should be in <span class="docutils literal"><span class="pre">~/.local/share/applications</span></span> instead of <span class="docutils literal"><span class="pre">/usr/share/…</span></span>), replace <span class="docutils literal"><span class="pre">Icon=/path/to/eclipse/icon.xpm</span></span> by <span class="docutils literal"><span class="pre">Icon=eclipse4</span></span>. You don’t need to add the .xpm suffix.</p>
<p>The <span class="docutils literal"><span class="pre">eclipse.desktop</span></span> will thus be something like this:</p>
<div class="highlight-ini"><div class="highlight"><pre><span class="k">[Desktop Entry]</span>
<span class="na">Version</span><span class="o">=</span><span class="s">1.0</span>
<span class="na">Name</span><span class="o">=</span><span class="s">Eclipse</span>
<span class="na">GenericName</span><span class="o">=</span><span class="s">Integrated Development Application</span>
<span class="na">Comment</span><span class="o">=</span><span class="s">Eclipse Juno</span>
<span class="na">Exec</span><span class="o">=</span><span class="s">/usr/local/bin/eclipse</span>
<span class="na">TryExec</span><span class="o">=</span><span class="s">/usr/local/bin/eclipse</span>
<span class="na">Icon</span><span class="o">=</span><span class="s">eclipse4</span>
<span class="na">Terminal</span><span class="o">=</span><span class="s">false</span>
<span class="na">Type</span><span class="o">=</span><span class="s">Application</span>
<span class="na">Categories</span><span class="o">=</span><span class="s">Development;IDE;</span>
</pre></div>
</div>
]]></description>
             <pubDate>Sat, 05 Jan 2013 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2012/11/21/open_an_application_with_a_specific_language_on_mac_os_x.html</link>
            <guid>http://blog.shichao.io/blog/html/2012/11/21/open_an_application_with_a_specific_language_on_mac_os_x.html</guid>
            <title><![CDATA[Open an application with a specific language on Mac OS X]]></title>
            <description><![CDATA[<h1>Open an application with a specific language on Mac OS X</h1>
<p>While using iTunes on Mac OS X I encounter some little different issues from those on Windows. For example, some quasi-ID3-edited MP3 files suffer Mojibake in Japanese texts. Simple built-in conversion does not render them well. Even changing the language/region setting to “Japanese” fails to fix that. However, when changing language setting to “Chinese”, everything seems back to normal.</p>
<p><img alt="s1" src="http://blog.shichao.io/blog/html/_images/Screen-Shot-2012-11-21-at-2.00.15-PM.png"/></p>
<p>As far as I can tell after exploration, the cause was probably importing songs containing Japanese characters on Windows (Chinese) and then transfering to Mac, because those retrieved on Mac seem alright. But this does not apply to all that has the problem; some other songs transferred from Windows remain intact.</p>
<p><a class="reference internal" href="http://blog.shichao.io/blog/html/_images/Screen-Shot-2012-11-21-at-2.14.31-PM.png"><img alt="s2" src="http://blog.shichao.io/blog/html/_images/Screen-Shot-2012-11-21-at-2.14.31-PM.png" style="width: 450px;"/></a></p>
<p>It sounds a horrible idea to re-edit all ID3 in a proper language environment, so setting iTunes to a default language may be a compromising solution. Hands-on workaround in a simple like <a class="reference external" href="http://hints.macworld.com/article.php?story=20061001065101830">this</a> does not work any longer, and a new tool shows up — <a class="reference external" href="http://www.macupdate.com/app/mac/31850/language-switcher">Language Switcher</a>.</p>
<p><a class="reference internal" href="http://blog.shichao.io/blog/html/_images/Screen-Shot-2012-11-21-at-2.30.03-PM.png"><img alt="s3" src="http://blog.shichao.io/blog/html/_images/Screen-Shot-2012-11-21-at-2.30.03-PM.png" style="width: 450px;"/></a></p>
<p>Install and open it, choose “Chinese (China)” as the default start-up language for iTunes and relaunch the program. As you can see, ID3 are displayed properly as if having the system switched into Chinese.</p>
<p><a class="reference internal" href="http://blog.shichao.io/blog/html/_images/Screen-Shot-2012-11-21-at-2.31.39-PM.png"><img alt="s4" src="http://blog.shichao.io/blog/html/_images/Screen-Shot-2012-11-21-at-2.31.39-PM.png" style="width: 450px;"/></a></p>
<p><strong>UPDATE</strong></p>
<p>As suggested by <a class="reference external" href="https://twitter.com/gnudog">drivel</a>, <span class="docutils literal"><span class="pre">mid3iconv</span> <span class="pre">-e</span> <span class="pre">GBK</span> <span class="pre">*.mp3</span></span> command from the <a class="reference external" href="https://pypi.python.org/pypi/mutagen">mutagen</a> Python package can used to solve the problem once for all.</p>
]]></description>
             <pubDate>Wed, 21 Nov 2012 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2012/10/29/hello_world_in_ocaml_with_eclipse.html</link>
            <guid>http://blog.shichao.io/blog/html/2012/10/29/hello_world_in_ocaml_with_eclipse.html</guid>
            <title><![CDATA[Hello World in OCaml with Eclipse]]></title>
            <description><![CDATA[<h1>Hello World in OCaml with Eclipse</h1>
<p>Assume Eclipse has been installed,</p>
<ol class="arabic">
<li><p class="first">Download and install OCaml (<a class="reference external" href="http://caml.inria.fr/download.en.html">http://caml.inria.fr/download.en.html</a>)</p>
</li>
<li><p class="first">Open Eclipse, Help -&gt; Install New Software, enter “<a class="reference external" href="http://www.algo-prog.info/ocaide">http://www.algo-prog.info/ocaide/</a>” as repository site, and install this plugin. Restart Eclipse after finish.</p>
</li>
<li><p class="first">Turn the current perspective into OCaml by Window -&gt; Open Perspective.</p>
</li>
<li><p class="first">Then, create a new project named “ocaml_hello” by New -&gt; OCaml Project. And create a new Module named “ocaml_hello” or simply a file with .ml extension.</p>
</li>
<li><p class="first">Write the code:</p>
<div class="highlight-ocaml"><div class="highlight"><pre><span class="n">print_string</span> <span class="s2">"Hello world!</span><span class="se">\n</span><span class="s2">"</span><span class="o">;;</span>
</pre></div>
</div>
</li>
<li><p class="first">Press F6 (Fn+F6 on Mac) or OCaml -&gt; Eval In Toplevel, and the console “OCaml Toplevel” at the bottom will output results.</p>
<p><img alt="s1" src="http://blog.shichao.io/blog/html/_images/Screen-Shot-2012-10-29-at-5.14.14-PM.png"/></p>
<p><img alt="s2" src="http://blog.shichao.io/blog/html/_images/Screen-Shot-2012-10-29-at-5.15.16-PM.png"/></p>
</li>
</ol>
]]></description>
             <pubDate>Mon, 29 Oct 2012 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2012/10/26/tricky_c_program_question_concerning_software_security.html</link>
            <guid>http://blog.shichao.io/blog/html/2012/10/26/tricky_c_program_question_concerning_software_security.html</guid>
            <title><![CDATA[Tricky C program question concerning software security]]></title>
            <description><![CDATA[<h1>Tricky C program question concerning software security</h1>
<p>While the software security exam is coming, I try to review some of the facultative homework. Just post one that seems impossible to figure out for me. May some “Da Niu” try to give a solution when seeing this by chance. The code has been modified a little in case… but without changing the original intention.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;stdio.h&gt;</span>
<span class="cp">#include &lt;stdlib.h&gt;</span>

<span class="kt">void</span> <span class="nf">foo</span><span class="p">(</span><span class="kt">char</span> <span class="n">s</span><span class="p">[]){</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span><span class="n">s</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="kt">char</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="n">foo</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">something shows up after exit"</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The question is to find an input in order that the program will print “something shows up after exit”. What the hell is that?</p>
]]></description>
             <pubDate>Fri, 26 Oct 2012 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2012/10/26/configure_sml_mode_on_emacs_for_standard_ml_on_mac_os_x.html</link>
            <guid>http://blog.shichao.io/blog/html/2012/10/26/configure_sml_mode_on_emacs_for_standard_ml_on_mac_os_x.html</guid>
            <title><![CDATA[Configure SML mode on Emacs for Standard ML on Mac OS X]]></title>
            <description><![CDATA[<h1>Configure SML mode on Emacs for Standard ML on Mac OS X</h1>
<p>Before start, we have to make sure the Emacs For Mac OS X has been installed, which can be retrieved at <a class="reference external" href="http://emacsformacosx.com">emacsformacosx.com</a>.</p>
<ol class="arabic">
<li><p class="first">Download the lastest distribution (110.75 as of posting date) of SML .dmg file from <a class="reference external" href="http://smlnj.cs.uchicago.edu/dist/working/110.75/index.html">this working site</a>, and then install it.</p>
</li>
<li><p class="first">Download the latest Emacs Lisp package for SML mode from <a class="reference external" href="http://www.iro.umontreal.ca/~monnier/elisp">this site</a>, which should be sml-mode-5.0.tar.gz at the time. Double-click the downloaded file and make it folder, and place the folder anywhere you like.</p>
</li>
<li><p class="first">Open terminal, create a file named <span class="docutils literal"><span class="pre">.emacs</span></span> at your user folder. Add the following lines of Lisp in the file:</p>
<div class="highlight-common-lisp"><div class="highlight"><pre><span class="p">(</span><span class="k">setq</span> <span class="nv">load-path</span> <span class="p">(</span><span class="nb">cons</span> <span class="s">"/path/to/sml-mode-5.0"</span> <span class="nv">load-path</span><span class="p">))</span>
<span class="p">(</span><span class="nb">load</span> <span class="s">"sml-mode-startup"</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="docutils literal"><span class="pre">/path/to/sml-mode-5.0</span></span> indicates the path to SML mode package downloaded in Step 2.</p>
<p>As the installation in Step 1 makes binary file of SML/NJ compiler placed at <span class="docutils literal"><span class="pre">/usr/local/smlnj-110.75/bin</span></span>, then you have to append the following lines into <span class="docutils literal"><span class="pre">.emacs</span></span>:</p>
<div class="highlight-common-lisp"><div class="highlight"><pre><span class="p">(</span><span class="nv">setenv</span> <span class="s">"PATH"</span> <span class="p">(</span><span class="nv">concat</span> <span class="s">"/usr/local/smlnj-110.75/bin:"</span> <span class="p">(</span><span class="nv">getenv</span> <span class="s">"PATH"</span><span class="p">)))</span>
<span class="p">(</span><span class="k">setq</span> <span class="nv">exec-path</span> <span class="p">(</span><span class="nb">cons</span> <span class="s">"/usr/local/smlnj-110.75/bin"</span>  <span class="nv">exec-path</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><p class="first">Configuration done.</p>
<p>Open Emacs, type <em>M-x</em> run-sml, a buffer should appear with “Standard ML of New Jersey” compiler info listed. You can now input and run ML code.</p>
<p><a class="reference internal" href="http://blog.shichao.io/blog/html/_images/Screen-Shot-2012-10-26-at-1.52.20-AM.png"><img alt="s1" src="http://blog.shichao.io/blog/html/_images/Screen-Shot-2012-10-26-at-1.52.20-AM.png" style="width: 450px;"/></a></p>
<p>To edit a file in SML, create a new file using <em>C-x C-f</em> with .sml extension, or create a file with whatever extension and type <em>M-x</em> sml-mode. Then the minibuffer region will become SML rather than Fundamental, and the syntax will be highlighted.</p>
<p><a class="reference internal" href="http://blog.shichao.io/blog/html/_images/Emacs_SML_up.png"><img alt="s2" src="http://blog.shichao.io/blog/html/_images/Emacs_SML_up.png" style="width: 450px;"/></a></p>
</li>
</ol>
]]></description>
             <pubDate>Fri, 26 Oct 2012 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2012/10/04/progress_speed_indicator_for_urlretrieve_in_python.html</link>
            <guid>http://blog.shichao.io/blog/html/2012/10/04/progress_speed_indicator_for_urlretrieve_in_python.html</guid>
            <title><![CDATA[Progress/speed indicator for urlretrieve() in Python]]></title>
            <description><![CDATA[<h1>Progress/speed indicator for urlretrieve() in Python</h1>
<p>A simple <span class="docutils literal"><span class="pre">reporthook()</span></span> function for <a class="reference external" href="http://docs.python.org/2/library/urllib.html#urllib.urlretrieve" title="(in Python v2.7)"><span class="xref py py-func docutils literal"><span class="pre">urllib.urlretrieve()</span></span></a>‘s reporthook argument:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">urllib</span>


<span class="k">def</span> <span class="nf">reporthook</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">block_size</span><span class="p">,</span> <span class="n">total_size</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">start_time</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="k">return</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="n">progress_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">count</span> <span class="o">*</span> <span class="n">block_size</span><span class="p">)</span>
    <span class="n">speed</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">progress_size</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="n">duration</span><span class="p">))</span>
    <span class="n">percent</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">count</span> <span class="o">*</span> <span class="n">block_size</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">total_size</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">"</span><span class="se">\r</span><span class="s">...</span><span class="si">%d%%</span><span class="s">, </span><span class="si">%d</span><span class="s"> MB, </span><span class="si">%d</span><span class="s"> KB/s, </span><span class="si">%d</span><span class="s"> seconds passed"</span> <span class="o">%</span>
                    <span class="p">(</span><span class="n">percent</span><span class="p">,</span> <span class="n">progress_size</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">),</span> <span class="n">speed</span><span class="p">,</span> <span class="n">duration</span><span class="p">))</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="n">urllib</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">reporthook</span><span class="p">)</span>
</pre></div>
</div>
<p>After writing <span class="docutils literal"><span class="pre">__main__</span></span> and designating url as well as filename for the sample file <span class="docutils literal"><span class="pre">urlre.py</span></span>, we can run it and see the effect.</p>
<p><img alt="s1" src="http://blog.shichao.io/blog/html/_images/Screen-Shot-2012-10-26-at-2.56.57-AM.png"/></p>
<p><strong>UPDATE</strong></p>
<p>As suggested by Naquada, to avoid thing like “106%” and so on, percent should be defined as <span class="docutils literal"><span class="pre">percent</span> <span class="pre">=</span> <span class="pre">min(int(count*blockSize*100/totalSize),100)</span></span>.</p>
]]></description>
             <pubDate>Thu, 04 Oct 2012 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2012/09/22/display_desktop_on_ipad_using_air_display_over_usb_tethering.html</link>
            <guid>http://blog.shichao.io/blog/html/2012/09/22/display_desktop_on_ipad_using_air_display_over_usb_tethering.html</guid>
            <title><![CDATA[Display desktop on iPad using Air Display over USB tethering]]></title>
            <description><![CDATA[<h1>Display desktop on iPad using Air Display over USB tethering</h1>
<p>I was recently exploring remote desktop apps (VNC/RDP things)  for iOS. Then, plenty of them show up, like iDisplay, Splashtop, PocketCloud, Air Display, Displaylink, 2x, etc (all available at App Store). These apps are able to mirror or sustain remote desktop control over computers through Wi-Fi or Bluetooth. Among them, Splashtop seems to have versatility on control and Air Display is fast in streaming.</p>
<p>While the idea of implementation via USB rather than Wi-Fi sounds easy, it doesn’t really work. The blog of Air Display support says: “In order for iOS apps like Air Display to access the USB bus via the 30-pin dock connector, its developer must be part of Apple’s Made for iPod/iPhone/iPad (MFi) program”. Nevertheless, they propose another solution, USB tethering.</p>
<p>According to this <a class="reference external" href="http://hijinksinc.com/2010/06/01/use-air-display-over-a-usb-cable">nifty workaround</a> (for Mac, but same for Windows), what we need is a jailbroken iOS device, then download and install MyWi 5 from Cydia on it. When turning on Air Display on both iOS and Windows, enable USB tethering using MyWi. With the network established, the Air Display on Windows will recognize the device. Then, by clicking on the option for this device, the mirror or remote desktop just work. The trial takes place under the same wireless LAN.</p>
]]></description>
             <pubDate>Sat, 22 Sep 2012 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2012/07/31/recommended_vpn_providers_in_china.html</link>
            <guid>http://blog.shichao.io/blog/html/2012/07/31/recommended_vpn_providers_in_china.html</guid>
            <title><![CDATA[推荐两个用于往国内翻的VPN]]></title>
            <description><![CDATA[<h1>推荐两个用于往国内翻的VPN</h1>
<p>非凡VPN（vpn123）和91vpn（n个代理网站，官网貌似木有域名是个ip地址）</p>
<p>还没有使用，初步查了一下。</p>
<p>共同的特点就是标题所示的，他们都有国内节点，适用于在国外的同学使用，用于访问国内的一些视频网站、CNTV以及其他用处（据说国外IP无法使用U盾之类验证的国内网上银行）。</p>
<p>前者做的比较实在，windows客户端界面比较好，支持PPTP、L2TP和OpenVPN，购买后可以查看服务器列表，因此可以比较方便的配置iPad/iPhone/Android，Windows 7下也可以通过配置VPN连接。而且提供测试账号。刚刚测试了一下美国测试节点，还可以，看youtube标清视频还算流畅。</p>
<p>后者貌似用的人更多，代理商也多，淘宝上就好多。支持PPTP、L2TP。声称全球3000多台服务器，但貌似不公布服务器列表（当然肯定有办法获得），网站上只说明了windows客户端的使用。</p>
]]></description>
             <pubDate>Tue, 31 Jul 2012 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2012/04/30/count_lines_of_code_with_cloc.html</link>
            <guid>http://blog.shichao.io/blog/html/2012/04/30/count_lines_of_code_with_cloc.html</guid>
            <title><![CDATA[代码行统计工具 CLOC]]></title>
            <description><![CDATA[<h1>代码行统计工具 CLOC</h1>
<p>Count Lines of Code (CLOC): <a class="reference external" href="http://cloc.sourceforge.net">http://cloc.sourceforge.net/</a></p>
<p>下载 Perl 脚本 cloc-1.56.pl 即可使用。</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">$ perl cloc-1.56.pl /var/local/pywikipedia/</span>
<span class="go">     290 text files.</span>
<span class="go">     273 unique files.</span>
<span class="go">      42 files ignored.</span>

<span class="go">http://cloc.sourceforge.net v 1.56  T=2.0 s (124.5 files/s, 50462.5 lines/s)</span>
<span class="go">--------------------------------------------------------------------------------</span>
<span class="go">Language                      files          blank        comment           code</span>
<span class="go">--------------------------------------------------------------------------------</span>
<span class="go">Python                          245           9139          18658          72906</span>
<span class="go">XML                               2             16              0            194</span>
<span class="go">Bourne Again Shell                1              0              5              6</span>
<span class="go">Bourne Shell                      1              0              0              1</span>
<span class="go">--------------------------------------------------------------------------------</span>
<span class="go">SUM:                            249           9155          18663          73107</span>
<span class="go">--------------------------------------------------------------------------------</span>
</pre></div>
</div>
]]></description>
             <pubDate>Mon, 30 Apr 2012 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2011/11/13/python_regex_matching.html</link>
            <guid>http://blog.shichao.io/blog/html/2011/11/13/python_regex_matching.html</guid>
            <title><![CDATA[Python正则表达式转义匹配]]></title>
            <description><![CDATA[<h1>Python正则表达式转义匹配</h1>
<p>由于学校的某个学生社团管理机构总是 DT 地不断更改并发布社团的分类和编号的版本，致使 wiki 站上的资料无法保证其内容的最新状态。今天，实在看不下去了，决定更新这80个社团的资料。</p>
<p>前几天已经利用空闲做好了新版社团分类的 wiki 表格文本（那个机构在其网站上连文字都懒得发布，直接发布的文档截图，害的我敲了100多行 wiki markup），今天提交到 MediaWiki 中。然后，还需要更新社团条目的导航模板，就必须将 wiki markup 中的社团名称外带其“[[ ]]”标记一起取出。手动取出的话需要选择-复制-粘贴80多次，并且还要做很多后续处理工作。于是决定写 python 用正则来处理。</p>
<p>使用 re.compile 和 findall 已经匹配出了类似于这样的内容：</p>
<div class="highlight-text"><div class="highlight"><pre>|A1001||[[北京科技大学电子竞技协会|电子竞技协会]]||
</pre></div>
</div>
<p>想在进行二次findall出“[[北京科技大学电子竞技协会|电子竞技协会]]”时，发现对“[”转义出现了问题。于是，上网查资料，发现了一篇文章 <a class="reference external" href="http://bbs.scmroad.com/viewthread.php?tid=21963">http://bbs.scmroad.com/viewthread.php?tid=21963</a> 。</p>
<p>明白了用法之后，使用“[[^]]+]]”进行匹配，成功findall “[[北京科技大学电子竞技协会|电子竞技协会]]”。然后 join 成字符串，print后提交至编辑页面之中。</p>
]]></description>
             <pubDate>Sun, 13 Nov 2011 00:00:00 -0800</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2011/10/18/managing_mediawiki_api_permissions.html</link>
            <guid>http://blog.shichao.io/blog/html/2011/10/18/managing_mediawiki_api_permissions.html</guid>
            <title><![CDATA[管理MediaWiki API使用权限]]></title>
            <description><![CDATA[<h1>管理MediaWiki API使用权限</h1>
<p>MediaWiki提供API接口用于外部程序访问和修改网站的数据库。一般来说，最常用的外部工具就是 pywikipediabot 机器人，用于半自动地处理大量繁琐编辑工作，或者自动地执行脚本，达到维护网站的目的。</p>
<p>然而，默认状态下，API 是对所有用户组群开放的（参见：<a class="reference external" href="http://www.mediawiki.org/wiki/Manual:User_rights#Default_rights">http://www.mediawiki.org/wiki/Manual:User_rights#Default_rights</a>），因为 <span class="docutils literal"><span class="pre">$wgEnableWriteAPI</span></span> 这个变量是隐式的 true，从而使得所有用户具有 writeapi 的默认权限。这将会对网站的安全带来隐患，尤其对于通过 API 对网站内容进行恶意破坏的机器人是毫无防御。通过简单的设置可以避免这类破坏，当然也仅仅是这类破坏，不能防止通过页面元素提交的破坏。</p>
<p>在 <span class="docutils literal"><span class="pre">LocalSettings.php</span></span> 中添加如下代码</p>
<div class="highlight-php"><div class="highlight"><pre><span class="x">$wgGroupPermissions['*']['writeapi'] = false; // forbid all anonymous writing api</span>
<span class="x">$wgGroupPermissions['user']['writeapi'] = false; // forbid all users (including autoconfirmed) writing api</span>
<span class="x">$wgGroupPermissions['bot']['writeapi'] = true; // allow those with bot flag to write api</span>
</pre></div>
</div>
<p>当然，anti-spam 需要的不仅仅是这一项。如果网站频遭人类或 bot 的 spam 或 vandalism，各类强大的插件比如：AbuseFilter、ConfirmEdit是可以使用的工具。不过前者主要用于 Wikipedia 这类大型 wiki；对于小型网站的话，后者的 Captcha 模块在需要的时候就会具有比较中肯的用处。</p>
]]></description>
             <pubDate>Tue, 18 Oct 2011 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2011/09/24/fixing_flash_disk.html</link>
            <guid>http://blog.shichao.io/blog/html/2011/09/24/fixing_flash_disk.html</guid>
            <title><![CDATA[U盘量产导致USB接口错误的解决方法]]></title>
            <description><![CDATA[<h1>U盘量产导致USB接口错误的解决方法</h1>
<p>上周用一个4G的爱国者U盘做了一个系统启动盘。系统装完后，第二天刚好要去复印室打印一个重要的东西去去找老师，发现我竟然没有多余的优盘。</p>
<p>没时间找了，再加上这个启动盘暂时没用了，于是打算格式化一下。但是突然发现无法格式化。想了很多方法，最终从网上下了一款U盘量产工具AlcorMP，把U盘修复了一下，大概20分钟，修复完毕后，U盘可以正常格式化了。第二天一早去打印了。</p>
<p>中午回来后，发现鼠标和外接的键盘都无反应了。打开Windows 7下的设备管理器，发现USB控制器下的一个Intel(R) 5 Series/3400 Series Chipset Family USB Enhanced Host Controller – 3B34出现了问题：该设备未能启动。手动禁用后再重启，鼠标和键盘都恢复了。可是重启后该问题依然继续。总不能让我以后每次一开机都要先进行“禁用-启用”操作后才能正常使用电脑吧？为了解决它，使用了很多方法，比如更新驱动，都没有用。</p>
<p>最后，在这个帖子 <a class="reference external" href="http://www.fanren8.com/read-htm-tid-31956.html">http://www.fanren8.com/read-htm-tid-31956.html</a> 里找到了解决办法。其实只要删除注册表几个键值就可以，记录下解决方法： 开始——运行——regedit— —来到键值[HKEY_LOCAL_MACHINESYSTEMCurrentControlSetControlClass处找到USB接口控制键值Universal Serial Bus controllers，保留默认键值以及Class，IconPath，NoInstallClass。重启后，一切正常！</p>
<p>问题是量产软件修改了注册表导致的</p>
]]></description>
             <pubDate>Sat, 24 Sep 2011 00:00:00 -0700</pubDate>
        </item>
    
        <item>
            <link>http://blog.shichao.io/blog/html/2011/08/19/installing_pywikipedia_on_windows.html</link>
            <guid>http://blog.shichao.io/blog/html/2011/08/19/installing_pywikipedia_on_windows.html</guid>
            <title><![CDATA[Windows下安装Pywikipediabot]]></title>
            <description><![CDATA[<h1>Windows下安装Pywikipediabot</h1>
<p>很早就想在MediaWiki上使用bot，但一直没有去关注。MediaWiki上的bot实现有很多途径，.NET，perl，java都有，但是貌似python最容易。于是选择了PyWikipediaBot。网上关于Pywikipedia中文的资料比较少，所以就自己按照meta-wiki上的Pywikipedia的instruction中的步骤进行安装，比较简单。</p>
<p>meta-wiki安装指南：<a class="reference external" href="http://meta.wikimedia.org/wiki/Pywikipediabot/Installation">http://meta.wikimedia.org/wiki/Pywikipediabot/Installation</a> （这个有中文版翻译）</p>
<p>安装环境：</p>
<p>Windows 7 Ultimate + Python 2.7 (pywikipedia不支持Python 3.X)</p>
<p>MediaWiki 1.16.2 ，单语言（简体中文）</p>
<p>1.下载Pywikipedia。</p>
<p>手动下载或者TortoiseSVN都可以，后者的好处是升级方便。</p>
<p>手动下载PyWikipediaBot Nightlies：<a class="reference external" href="http://toolserver.org/~pywikipedia/nightly">http://toolserver.org/~pywikipedia/nightly/</a></p>
<p>随便选一个：<a class="reference external" href="http://toolserver.org/~pywikipedia/nightly/package/pywikipedia/pywikipedia-nightly.7z">http://toolserver.org/~pywikipedia/nightly/package/pywikipedia/pywikipedia-nightly.7z</a></p>
<p>TortoiseSVN：<a class="reference external" href="http://svn.wikimedia.org/svnroot/pywikipedia/trunk/pywikipedia">http://svn.wikimedia.org/svnroot/pywikipedia/trunk/pywikipedia/</a></p>
<ol class="arabic simple" start="2">
<li>设置快捷键。</li>
</ol>
<p>Linux下直接export一个变量就行了：</p>
<div class="highlight-shell-session"><div class="highlight"><pre><span class="go">PYTHONPATH=$PYTHONPATH:~/pywikipedia/</span>
<span class="go">export PYTHONPATH</span>
</pre></div>
</div>
<p>Windows下简单的方法就是：为pywikipedia目录创建快捷方式，然后编辑属性，目标写cmd.exe，起始位置写该目录的路径，确定后单击该快捷方式可以直接进入cmd并且在该目录下</p>
<ol class="arabic simple" start="3">
<li>配置。</li>
</ol>
<p>参考 <a class="reference external" href="http://meta.wikimedia.org/wiki/Pywikipediabot/Use_on_non-Wikimedia_wikis">http://meta.wikimedia.org/wiki/Pywikipediabot/Use_on_non-Wikimedia_wikis</a>。</p>
<p>按照安装指南，应该先创建family.py，再创建user-config.py。</p>
<p>3.1. 创建yourwiki_family.py，直接在/families中现成的py文件中选择一个，复制并修改即可，我改的就是最简单的“mozilla_family.py”，文件命名为“你wiki的名字_family.py”：</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># -*- coding: utf-8  -*-</span>

<span class="kn">import</span> <span class="nn">family</span>

<span class="k">class</span> <span class="nc">Family</span><span class="p">(</span><span class="n">family</span><span class="o">.</span><span class="n">Family</span><span class="p">):</span>

     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
         <span class="n">family</span><span class="o">.</span><span class="n">Family</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'yourwiki'</span> <span class="c"># 设置family名称，就是“你wiki的名字”（文件名下划线前面的部分）</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">langs</span> <span class="o">=</span> <span class="p">{</span>
             <span class="s">'en'</span><span class="p">:</span> <span class="s">'localhost'</span><span class="p">,</span> <span class="c"># 语言和主机名。语言设成en即可（之前一直登录失败就是在这写成了zh-cn，后来改成en后可用了）</span>
         <span class="p">}</span>

         <span class="bp">self</span><span class="o">.</span><span class="n">namespaces</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
             <span class="s">'_default'</span><span class="p">:</span> <span class="s">u'YourWiki'</span><span class="p">,</span> <span class="c">#  计划页面的命名空间，一般就是LocalSettings.php中的$Sitename的值</span>
         <span class="p">}</span>

         <span class="bp">self</span><span class="o">.</span><span class="n">namespaces</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
             <span class="s">'_default'</span><span class="p">:</span> <span class="s">u'YourWiki talk'</span><span class="p">,</span> <span class="c"># 计划页面讨论页的命名空间</span>
         <span class="p">}</span>

     <span class="k">def</span> <span class="nf">version</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
         <span class="k">return</span> <span class="s">"1.16.1"</span>  <span class="c"># MediaWiki版本号，这个貌似不重要</span>

     <span class="k">def</span> <span class="nf">scriptpath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
         <span class="k">return</span> <span class="s">'/wiki'</span> <span class="c"># index.php, api.php的脚步相对路径，这个和你wiki所在具体路有关，比如你的MediaWiki在/wiki目录下，那么这里就写“/wiki”</span>
</pre></div>
</div>
<p class="readmorewrapper"><a class="readmore" href="http://blog.shichao.io/blog/html/2011/08/19/installing_pywikipedia_on_windows.html#more">Read more...</a></p> 
 
 
 
 
 
 
 
 
 
 
 
]]></description>
             <pubDate>Fri, 19 Aug 2011 00:00:00 -0700</pubDate>
        </item>
    
    </channel>
</rss>